function loadJS(e,o,t){var i=!!window.ActiveXObject,n=i&&!window.XMLHttpRequest,a=document.createElement("script"),r=n?document.documentElement:document.getElementsByTagName("head")[0];a.type="text/javascript",a.async=!0,a.readyState?a.onreadystatechange=function(){"loaded"!=a.readyState&&"complete"!=a.readyState||(a.onreadystatechange=null,o&&o())}:a.onload=function(){o&&o()},a.src=e,t?document.getElementById(t).appendChild(a):r.insertBefore(a,r.firstChild)}$.fn.extend({isOnScreenVisible:function(){if(!$("body").hasClass("post-template"))return!1;var e=$(window),o={top:e.scrollTop(),left:e.scrollLeft()};o.right=o.left+e.width(),o.bottom=o.top+e.height();var t=this.offset();return t.right=t.left+this.outerWidth(),t.bottom=t.top+this.outerHeight(),!(o.right<t.left||o.left>t.right||o.bottom<t.top||o.top>t.bottom)}});var General={isMobile:!1,isWechat:!1,viewWidth:$(window).width(),absUrl:location.protocol+"//"+location.host,init:function(){var e=window,o=(e.document,navigator.userAgent.toLowerCase()),t=e.navigator.appVersion.match(/android/gi);e.navigator.appVersion.match(/iphone/gi);"micromessenger"==o.match(/MicroMessenger/i)&&(General.isWechat=!0,$("body").addClass("wechat-webview")),t&&(General.isMobile=!0),$("body").hasClass("post-template")&&(General.updateImageWidth(),General.rewardLoader()),General.webFontLoader(),General.scrollToPos()},updateImageWidth:function(){function e(){var e=$(this),o=t.outerWidth(),i=this.naturalWidth;i>=o?e.addClass("full-img"):e.removeClass("full-img")}function o(){i.each(e)}var t=$(".post-content"),i=$(".single-post-inner img").on("load",e);o()},webFontLoader:function(){WebFontConfig={loading:function(){},custom:{families:["iconfont","fontawesome"],urls:["https://img.halfrost.com/iconfonts/iconfont.css",General.absUrl+"/assets/css/font-awesome.min.css"]}},loadJS(General.absUrl+"/assets/js/webfont.js",function(){WebFont.load({custom:{families:["iconfont","fontawesome"]}})})},scrollToPos:function(e){var o="我要飞到最高",t=(e||$(window).height(),$('<a aria-label="top" href="#" id="to-top" title="'+o+'"> <div class="to-top-wrap"></div></a>').appendTo("body"));$(window).scroll(function(){$(window).scrollTop()>$(window).height()?t.fadeIn(500):t.fadeOut(500)}),t.click(function(e){e.preventDefault(),$("html,body").animate({scrollTop:0},666,function(){window.location.hash="#"})})},urlIconlize:function(e){var o,t,i={twitter:"iconfont-twitter icon-iconfonttwitter",qzone:"iconfont-qzone icon-qzone",weibo:"iconfont-weibo icon-iconfontweibo",facebook:"iconfont-facebook icon-iconfontfacebook",github:"iconfont-github icon-github",douban:"iconfont-douban icon-iconfontdouban",google:"iconfont-google icon-iconfontgoogle",luolei:"iconfont-luolei icon-luolei",dribble:"iconfont-dribble icon-dribbblecircled",v2ex:"iconfont-v2ex icon-iconfontv2ex",zhihu:"iconfont-zhihu icon-iconfontzhihu",wikipedia:"iconfont-wikipedia icon-iconfontwikipedia",jianshu:"iconfont-jianshu icon-jianshu",youku:"iconfont-youku icon-iconfontyouku",youtube:"iconfont-youtube icon-youtube",juejin:"iconfont-juejin icon-juejin",weixin:"iconfont-weixin icon-iconfontwechat",segmentfault:"iconfont-sf icon-iconsf-copy"};for(var n in i)if("function"!=typeof i[n]){var a=n;e.indexOf(a)>=0&&(o=a,t=i[a])}return t},addIcons:function(){$(".single-post-inner  a:not(:has(img))").each(function(e){var o=$(this).attr("href"),t=document.createElement("a");t.href=o,_selfDomain=t.hostname,General.urlIconlize(_selfDomain),$(this).prepend('<i class="iconfont '+General.urlIconlize(_selfDomain)+'"></i>');var i=$(this).find("i").css("color"),n=$(this).css("color");$(this).hover(function(){$(this).css("color",i),$(this).addClass("animated pulse")},function(){$(this).css("color",n),$(this).removeClass("animated pulse")})})},rewardLoader:function(){var e={alipay:"/assets/images/qr-alipay-255.png",wechat:"/assets/images/qr-wechat-255.png"};General.isWechat&&$(".wechat-code b").html("长按上方二维码打赏作者"),$(".money-like .reward-button").hover(function(){$("img.wechat-img").attr("src",e.wechat),$("img.alipay-img").attr("src",e.alipay),$(".money-code").fadeIn(),$(this).addClass("active")},function(){$(".money-code").fadeOut(),$(this).removeClass("active")},800),$(".money-like .reward-button").click(function(){$(this).hasClass("active")?($(this).find("img.wechat-img").attr("src",e.wechat),$(this).find("img.alipay-img").attr("src",e.alipay),$(".money-code").fadeOut(),$(this).removeClass("active")):($(".money-code").fadeIn(),$(this).addClass("active"))})}},ImageSmartLoader={isWebPSupported:!1,isImageCompressed:!1,init:function(){ImageSmartLoader.webPCheck()},isCompressedCheck:function(){},webPCheck:function(e,o){var t={demo:"UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAsAAAABBxAREYiI/gcAAABWUDggGAAAADABAJ0BKgEAAQABABwlpAADcAD+/gbQAA=="},i=new Image;i.onload=function(){i.width>0&&i.height>0;ImageSmartLoader.isWebPSupported=!0,ImageSmartLoader.webPLoader()},i.onerror=function(){ImageSmartLoader.isWebPSupported=!1,ImageSmartLoader.webPLoader()},i.src="data:image/webp;base64,"+t.demo},imgLoader:function(){},webPLoader:function(){if(ImageSmartLoader.isWebPSupported===!0){if(768==General.viewWidth)return $(".lazy").lazyload({advanced_load:!0,data_attribute:"url",webP_load:!0,is_scale:!1}),!1;General.viewWidth<768?$(".lazy").lazyload({advanced_load:!0,data_attribute:"url",webP_load:!0,is_scale:!0,scale_width:750}):$(".lazy").lazyload({advanced_load:!0,data_attribute:"url",webP_load:!0,is_scale:!1})}else{if(768==General.viewWidth)return $(".lazy").lazyload({advanced_load:!0,data_attribute:"url",webP_load:!1,is_scale:!0,scale_width:1500}),!1;General.viewWidth<768?$(".lazy").lazyload({advanced_load:!0,data_attribute:"url",webP_load:!1,is_scale:!0,scale_width:750}):$(".lazy").lazyload({advanced_load:!1,data_attribute:"url",webP_load:!1,is_scale:!1})}}};$(document).ready(function(){var e=$(window),o=document.getElementById("scroll-hint");if(null!==o&&($(".header-scroll-hint").on("click",function(e){var o=$(this).closest(".cover");$("html, body").animate({scrollTop:o.position().top+o.height()},400),e.preventDefault()}),window.addEventListener("load",function(){var e=window.pageYOffset||document.documentElement.scrollTop;e>0?o.classList.remove("visible"):o.classList.add("visible")}),window.addEventListener("scroll",function(){var e=window.pageYOffset||document.documentElement.scrollTop;e>0?o.classList.remove("visible"):o.classList.add("visible")})),$("#toc").initTOC({selector:"h1, h2, h3, h4, h5, h6",scope:"article",overwrite:!1,prefix:"toc"}),$(".sidebar-toggle").on("click",function(e){$("body").hasClass("sidebar-opened")?($("body").removeClass("sidebar-opened"),$("body").css("overflow","scroll")):($("body").addClass("sidebar-opened"),$("body").css("overflow","hidden")),e.preventDefault()}),$(".search-toggle").on("click",function(e){$("body").hasClass("search-opened")?($("body").removeClass("search-opened"),$("body").css("overflow","scroll"),searchField.clear()):($("body").addClass("search-opened"),$("body").css("overflow","hidden"),setTimeout(function(){$("#search-field").focus()},300)),e.preventDefault()}),$(".overlay").on("click",function(e){$("body").removeClass("sidebar-opened search-opened"),$("body").css("overflow","scroll"),searchField.clear(),e.preventDefault()}),"undefined"!=typeof disqus_shortname){var t=!1;$(".comments-title").on("click",function(){var e=$(this);t?($("#disqus_thread").slideToggle(),e.hasClass("toggled-on")?e.removeClass("toggled-on"):e.addClass("toggled-on")):($.ajax({type:"GET",url:"//"+disqus_shortname+".disqus.com/embed.js",dataType:"script",cache:!0}),e.addClass("toggled-on"),t=!0)})}$.fn.lazyload=function(o){function t(){var e=0;n.each(function(){var o=$(this);if(!a.skip_invisible||o.is(":visible"))if($.abovethetop(this,a)||$.leftofbegin(this,a));else if($.belowthefold(this,a)||$.rightoffold(this,a)){if(++e>a.failure_limit)return!1}else o.trigger("appear"),e=0})}var i,n=this,a={threshold:0,failure_limit:0,event:"scroll",effect:"show",container:window,data_attribute:"original",skip_invisible:!1,appear:null,load:null,placeholder:"",advanced_load:!1,webP_load:!1,is_scale:!1,scale_width:750};return o&&(void 0!==o.failurelimit&&(o.failure_limit=o.failurelimit,delete o.failurelimit),void 0!==o.effectspeed&&(o.effect_speed=o.effectspeed,delete o.effectspeed),$.extend(a,o)),i=void 0===a.container||a.container===window?e:$(a.container),0===a.event.indexOf("scroll")&&i.bind(a.event,function(){return t()}),this.each(function(){var e=this,o=$(e);e.loaded=!1,void 0!==o.attr("src")&&o.attr("src")!==!1||o.is("img")&&(o.attr("src",a.placeholder),o.addClass("loading")),o.one("appear",function(){if(!this.loaded){if(a.appear){var t=n.length;a.appear.call(e,t,a)}var i=o.attr("data-"+a.data_attribute);void 0===i&&(i=o.attr("src")),void 0===i&&(i=o.style.backgroundImage),void 0!==i&&i.indexOf("img.halfrost.com")>-1&&(a.advanced_load===!0&&(i+="?imageView2"),a.is_scale===!0&&(i+="/0/w/"+a.scale_width),a.webP_load===!0&&a.is_scale===!1&&(i+="/0/format/webp"),a.webP_load===!0&&a.is_scale===!0&&(i+="/format/webp"),a.webP_load===!1&&i.indexOf("https://img.halfrost.com/Blog/ArticleTitleImage/background-cover_.png")>-1&&(i="https://img.halfrost.com/Blog/ArticleTitleImage/background-cover_.png")),$("<img />").bind("load",function(){o.hide(),o.is("img")?o.attr("src",i):o.css("background-image","url('"+i+"')"),o[a.effect](a.effect_speed),e.loaded=!0;var t=$.grep(n,function(e){return!e.loaded});if(n=$(t),a.load){var r=n.length;a.load.call(e,r,a)}o.removeClass("loading")}).attr("src",i)}}),0!==a.event.indexOf("scroll")&&o.bind(a.event,function(){e.loaded||o.trigger("appear")})}),e.bind("resize",function(){t()}),/(?:iphone|ipod|ipad).*os 5/gi.test(navigator.appVersion)&&e.bind("pageshow",function(e){e.originalEvent&&e.originalEvent.persisted&&n.each(function(){$(this).trigger("appear")})}),$(document).ready(function(){t()}),this},$.belowthefold=function(o,t){var i;return i=void 0===t.container||t.container===window?(window.innerHeight?window.innerHeight:e.height())+e.scrollTop():$(t.container).offset().top+$(t.container).height(),i<=$(o).offset().top-t.threshold},$.rightoffold=function(o,t){var i;return i=void 0===t.container||t.container===window?e.width()+e.scrollLeft():$(t.container).offset().left+$(t.container).width(),i<=$(o).offset().left-t.threshold},$.abovethetop=function(o,t){var i;return i=void 0===t.container||t.container===window?e.scrollTop():$(t.container).offset().top,i>=$(o).offset().top+t.threshold+$(o).height()},$.leftofbegin=function(o,t){var i;return i=void 0===t.container||t.container===window?e.scrollLeft():$(t.container).offset().left,i>=$(o).offset().left+t.threshold+$(o).width()},$.inviewport=function(e,o){return!($.rightoffold(e,o)||$.leftofbegin(e,o)||$.belowthefold(e,o)||$.abovethetop(e,o))},$.extend($.expr[":"],{"below-the-fold":function(e){return $.belowthefold(e,{threshold:0})},"above-the-top":function(e){return!$.belowthefold(e,{threshold:0})},"right-of-screen":function(e){return $.rightoffold(e,{threshold:0})},"left-of-screen":function(e){return!$.rightoffold(e,{threshold:0})},"in-viewport":function(e){return $.inviewport(e,{threshold:0})},"above-the-fold":function(e){return!$.belowthefold(e,{threshold:0})},"right-of-fold":function(e){return $.rightoffold(e,{threshold:0})},"left-of-fold":function(e){return!$.rightoffold(e,{threshold:0})}}),General.init(),ImageSmartLoader.init(),$("body").hasClass("post-template")&&General.addIcons()});
!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}(function(e){"use strict";var n=function(e){if("string"!=typeof e)return 0;var n=e.match(/\d/g);return n?Math.min.apply(null,n):1},t=function(n,t){for(;t--;)n=e("<ol/>").appendTo(n),t&&(n=e("<li/>").appendTo(n));return n},r=function(e,n){for(;n--;)e=e.parent();return e},o=function(e,n){return function(t,r,o){var i=t.text(),a=n+"-"+o;r.text(i);var c=t[0],f=r[0],u=e?a:c.id||a;u=encodeURIComponent(u),c.id=u,f.href="#"+u}},i=function(i){var a=i.selector,c=i.scope,f=e("<ol/>"),u=f,p=null,s=n(a),l=o(i.overwrite,i.prefix);return e(c).find(a).each(function(o,i){var a=n(i.tagName),c=a-s;c>0&&(u=t(p,c)),c<0&&(u=r(u,2*-c)),u.length||(u=f);var h=e("<li/>"),d=e("<a/>");l(e(i),d,o),h.append(d).appendTo(u),p=h,s=a}),f};e.fn.initTOC=function(n){var t={selector:"h1, h2, h3, h4, h5, h6",scope:"body",overwrite:!1,prefix:"toc"};n=e.extend(t,n);var r=n.selector;if("string"!=typeof r)throw new TypeError("selector must be a string");if(!r.match(/^(?:h[1-6],?\s*)+$/g))throw new TypeError("selector must contains only h1-6");e(this).append(i(n));var o=location.hash;return o&&setTimeout(function(){var e=document.getElementById(o.slice(1));e&&e.scrollIntoView()},0),e(this)}});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJhc2UuanMiLCJqcXVlcnkudG9jLmpzIl0sIm5hbWVzIjpbImxvYWRKUyIsInVybCIsImNhbGxiYWNrIiwiZWwiLCJpc0lFIiwid2luZG93IiwiQWN0aXZlWE9iamVjdCIsImlzSUU2IiwiWE1MSHR0cFJlcXVlc3QiLCJzY3JpcHQiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJoZWFkIiwiZG9jdW1lbnRFbGVtZW50IiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJ0eXBlIiwiYXN5bmMiLCJyZWFkeVN0YXRlIiwib25yZWFkeXN0YXRlY2hhbmdlIiwib25sb2FkIiwic3JjIiwiZ2V0RWxlbWVudEJ5SWQiLCJhcHBlbmRDaGlsZCIsImluc2VydEJlZm9yZSIsImZpcnN0Q2hpbGQiLCIkIiwiZm4iLCJleHRlbmQiLCJpc09uU2NyZWVuVmlzaWJsZSIsImhhc0NsYXNzIiwid2luIiwidmlld3BvcnQiLCJ0b3AiLCJzY3JvbGxUb3AiLCJsZWZ0Iiwic2Nyb2xsTGVmdCIsInJpZ2h0Iiwid2lkdGgiLCJib3R0b20iLCJoZWlnaHQiLCJib3VuZHMiLCJ0aGlzIiwib2Zmc2V0Iiwib3V0ZXJXaWR0aCIsIm91dGVySGVpZ2h0IiwiR2VuZXJhbCIsImlzTW9iaWxlIiwiaXNXZWNoYXQiLCJ2aWV3V2lkdGgiLCJhYnNVcmwiLCJsb2NhdGlvbiIsInByb3RvY29sIiwiaG9zdCIsImluaXQiLCJVQSIsIm5hdmlnYXRvciIsInVzZXJBZ2VudCIsInRvTG93ZXJDYXNlIiwiaXNBbmRyb2lkIiwiYXBwVmVyc2lvbiIsIm1hdGNoIiwiYWRkQ2xhc3MiLCJ1cGRhdGVJbWFnZVdpZHRoIiwicmV3YXJkTG9hZGVyIiwid2ViRm9udExvYWRlciIsInNjcm9sbFRvUG9zIiwiJHRoaXMiLCJjb250ZW50V2lkdGgiLCIkcG9zdENvbnRlbnQiLCJpbWFnZVdpZHRoIiwibmF0dXJhbFdpZHRoIiwicmVtb3ZlQ2xhc3MiLCJjYXNwZXJGdWxsSW1nIiwiJGltZyIsImVhY2giLCJvbiIsIldlYkZvbnRDb25maWciLCJsb2FkaW5nIiwiY3VzdG9tIiwiZmFtaWxpZXMiLCJ1cmxzIiwiV2ViRm9udCIsImxvYWQiLCJwb3NpdGlvbiIsIlNUUl9UT19UT1AiLCJidXR0b24iLCJhcHBlbmRUbyIsInNjcm9sbCIsImZhZGVJbiIsImZhZGVPdXQiLCJjbGljayIsImUiLCJwcmV2ZW50RGVmYXVsdCIsImFuaW1hdGUiLCJoYXNoIiwidXJsSWNvbmxpemUiLCJkb21haW4iLCJfb3V0cHV0IiwiaWNvbk1hcCIsInR3aXR0ZXIiLCJxem9uZSIsIndlaWJvIiwiZmFjZWJvb2siLCJnaXRodWIiLCJkb3ViYW4iLCJnb29nbGUiLCJsdW9sZWkiLCJkcmliYmxlIiwidjJleCIsInpoaWh1Iiwid2lraXBlZGlhIiwiamlhbnNodSIsInlvdWt1IiwieW91dHViZSIsImp1ZWppbiIsIndlaXhpbiIsInNlZ21lbnRmYXVsdCIsIm5hbWUiLCJNYXBLZXkiLCJpbmRleE9mIiwiYWRkSWNvbnMiLCJpIiwiX3NyYyIsImF0dHIiLCJ0bXAiLCJocmVmIiwiX3NlbGZEb21haW4iLCJob3N0bmFtZSIsInByZXBlbmQiLCJfc2VsZkNvbG9yIiwiZmluZCIsImNzcyIsIl9vcmlnaW5hbENvbG9yIiwiaG92ZXIiLCJsb2FkUVIiLCJhbGlwYXkiLCJ3ZWNoYXQiLCJodG1sIiwiSW1hZ2VTbWFydExvYWRlciIsImlzV2ViUFN1cHBvcnRlZCIsImlzSW1hZ2VDb21wcmVzc2VkIiwid2ViUENoZWNrIiwiaXNDb21wcmVzc2VkQ2hlY2siLCJmZWF0dXJlIiwiVGVzdEltYWdlcyIsImRlbW8iLCJpbWciLCJJbWFnZSIsIndlYlBMb2FkZXIiLCJvbmVycm9yIiwiaW1nTG9hZGVyIiwibGF6eWxvYWQiLCJhZHZhbmNlZF9sb2FkIiwiZGF0YV9hdHRyaWJ1dGUiLCJ3ZWJQX2xvYWQiLCJpc19zY2FsZSIsInNjYWxlX3dpZHRoIiwicmVhZHkiLCIkd2luZG93Iiwic2Nyb2xsSGludCIsIiRjb3ZlciIsImNsb3Nlc3QiLCJhZGRFdmVudExpc3RlbmVyIiwicGFnZVlPZmZzZXQiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJhZGQiLCJpbml0VE9DIiwic2VsZWN0b3IiLCJzY29wZSIsIm92ZXJ3cml0ZSIsInByZWZpeCIsInNlYXJjaEZpZWxkIiwiY2xlYXIiLCJzZXRUaW1lb3V0IiwiZm9jdXMiLCJkaXNxdXNfc2hvcnRuYW1lIiwiZGlzcXVzX2xvYWRlZCIsIl90aGlzIiwic2xpZGVUb2dnbGUiLCJhamF4IiwiZGF0YVR5cGUiLCJjYWNoZSIsIm9wdGlvbnMiLCJ1cGRhdGUiLCJjb3VudGVyIiwiZWxlbWVudHMiLCJzZXR0aW5ncyIsInNraXBfaW52aXNpYmxlIiwiaXMiLCJhYm92ZXRoZXRvcCIsImxlZnRvZmJlZ2luIiwiYmVsb3d0aGVmb2xkIiwicmlnaHRvZmZvbGQiLCJmYWlsdXJlX2xpbWl0IiwidHJpZ2dlciIsIiRjb250YWluZXIiLCJ0aHJlc2hvbGQiLCJldmVudCIsImVmZmVjdCIsImNvbnRhaW5lciIsImFwcGVhciIsInBsYWNlaG9sZGVyIiwidW5kZWZpbmVkIiwiZmFpbHVyZWxpbWl0IiwiZWZmZWN0c3BlZWQiLCJlZmZlY3Rfc3BlZWQiLCJiaW5kIiwic2VsZiIsIiRzZWxmIiwibG9hZGVkIiwib25lIiwiZWxlbWVudHNfbGVmdCIsImxlbmd0aCIsImNhbGwiLCJ1cGRhdGVkVXJsIiwic3R5bGUiLCJiYWNrZ3JvdW5kSW1hZ2UiLCJoaWRlIiwidGVtcCIsImdyZXAiLCJlbGVtZW50IiwidGVzdCIsIm9yaWdpbmFsRXZlbnQiLCJwZXJzaXN0ZWQiLCJmb2xkIiwiaW5uZXJIZWlnaHQiLCJpbnZpZXdwb3J0IiwiZXhwciIsImJlbG93LXRoZS1mb2xkIiwiYSIsImFib3ZlLXRoZS10b3AiLCJyaWdodC1vZi1zY3JlZW4iLCJsZWZ0LW9mLXNjcmVlbiIsImluLXZpZXdwb3J0IiwiYWJvdmUtdGhlLWZvbGQiLCJyaWdodC1vZi1mb2xkIiwibGVmdC1vZi1mb2xkIiwiZmFjdG9yeSIsImRlZmluZSIsImFtZCIsImpRdWVyeSIsImdldExldmVsIiwiaGVhZGVyIiwiZGVjcyIsIk1hdGgiLCJtaW4iLCJhcHBseSIsImNyZWF0ZUxpc3QiLCIkd3JhcHBlciIsImNvdW50IiwianVtcEJhY2siLCIkY3VycmVudFdyYXBwZXIiLCJwYXJlbnQiLCJzZXRBdHRycyIsIiRzcmMiLCIkdGFyZ2V0IiwiaW5kZXgiLCJjb250ZW50IiwidGV4dCIsInByZSIsInRhcmdldCIsImlkIiwiZW5jb2RlVVJJQ29tcG9uZW50IiwiYnVpbGRUT0MiLCIkcmV0IiwiJGxhc3RMaSIsInByZXZEZXB0aCIsIl9zZXRBdHRycyIsImVsZW0iLCJjdXJyZW50RGVwdGgiLCJ0YWdOYW1lIiwiJGxpIiwiJGEiLCJhcHBlbmQiLCJkZWZhdWx0T3B0cyIsIlR5cGVFcnJvciIsImN1cnJlbnRIYXNoIiwiYW5jaG9yIiwic2xpY2UiLCJzY3JvbGxJbnRvVmlldyJdLCJtYXBwaW5ncyI6IkFBdUJBLFFBQVNBLFFBQU9DLEVBQUtDLEVBQVVDLEdBQzNCLEdBQUlDLEtBQVNDLE9BQU9DLGNBQ2hCQyxFQUFRSCxJQUFTQyxPQUFPRyxlQUN4QkMsRUFBU0MsU0FBU0MsY0FBYyxVQUNoQ0MsRUFBT0wsRUFBUUcsU0FBU0csZ0JBQWtCSCxTQUFTSSxxQkFBcUIsUUFBUSxFQUNwRkwsR0FBT00sS0FBTyxrQkFDZE4sRUFBT08sT0FBUSxFQUNYUCxFQUFPUSxXQUNQUixFQUFPUyxtQkFBcUIsV0FDQyxVQUFyQlQsRUFBT1EsWUFBK0MsWUFBckJSLEVBQU9RLGFBQ3hDUixFQUFPUyxtQkFBcUIsS0FDeEJoQixHQUNBQSxNQUtaTyxFQUFPVSxPQUFTLFdBQ1JqQixHQUNBQSxLQUlaTyxFQUFPVyxJQUFNbkIsRUFDVEUsRUFDQU8sU0FBU1csZUFBZWxCLEdBQUltQixZQUFZYixHQUV4Q0csRUFBS1csYUFBYWQsRUFBUUcsRUFBS1ksWUFsRHZDQyxFQUFFQyxHQUFHQyxRQUVEQyxrQkFBbUIsV0FDZixJQUFLSCxFQUFFLFFBQVFJLFNBQVMsaUJBQ3BCLE9BQU8sQ0FFWCxJQUFJQyxHQUFNTCxF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Y2VzQ29udGVudCI6WyIkLmZuLmV4dGVuZCh7XG5cbiAgICBpc09uU2NyZWVuVmlzaWJsZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICghJCgnYm9keScpLmhhc0NsYXNzKCdwb3N0LXRlbXBsYXRlJykpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgd2luID0gJCh3aW5kb3cpO1xuICAgICAgICB2YXIgdmlld3BvcnQgPSB7XG4gICAgICAgICAgICB0b3A6IHdpbi5zY3JvbGxUb3AoKSxcbiAgICAgICAgICAgIGxlZnQ6IHdpbi5zY3JvbGxMZWZ0KClcbiAgICAgICAgfTtcbiAgICAgICAgdmlld3BvcnQucmlnaHQgPSB2aWV3cG9ydC5sZWZ0ICsgd2luLndpZHRoKCk7XG4gICAgICAgIHZpZXdwb3J0LmJvdHRvbSA9IHZpZXdwb3J0LnRvcCArIHdpbi5oZWlnaHQoKTtcblxuICAgICAgICB2YXIgYm91bmRzID0gdGhpcy5vZmZzZXQoKTtcbiAgICAgICAgYm91bmRzLnJpZ2h0ID0gYm91bmRzLmxlZnQgKyB0aGlzLm91dGVyV2lkdGgoKTtcbiAgICAgICAgYm91bmRzLmJvdHRvbSA9IGJvdW5kcy50b3AgKyB0aGlzLm91dGVySGVpZ2h0KCk7XG5cbiAgICAgICAgcmV0dXJuICghKHZpZXdwb3J0LnJpZ2h0IDwgYm91bmRzLmxlZnQgfHwgdmlld3BvcnQubGVmdCA+IGJvdW5kcy5yaWdodCB8fCB2aWV3cG9ydC5ib3R0b20gPCBib3VuZHMudG9wIHx8IHZpZXdwb3J0LnRvcCA+IGJvdW5kcy5ib3R0b20pKTtcbiAgICB9LFxuXG59KTtcblxuZnVuY3Rpb24gbG9hZEpTKHVybCwgY2FsbGJhY2ssIGVsKSB7XG4gICAgdmFyIGlzSUUgPSAhIXdpbmRvdy5BY3RpdmVYT2JqZWN0LFxuICAgICAgICBpc0lFNiA9IGlzSUUgJiYgIXdpbmRvdy5YTUxIdHRwUmVxdWVzdCxcbiAgICAgICAgc2NyaXB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNjcmlwdFwiKSxcbiAgICAgICAgaGVhZCA9IGlzSUU2ID8gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50IDogZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJoZWFkXCIpWzBdO1xuICAgIHNjcmlwdC50eXBlID0gXCJ0ZXh0L2phdmFzY3JpcHRcIjtcbiAgICBzY3JpcHQuYXN5bmMgPSB0cnVlO1xuICAgIGlmIChzY3JpcHQucmVhZHlTdGF0ZSkge1xuICAgICAgICBzY3JpcHQub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAoc2NyaXB0LnJlYWR5U3RhdGUgPT0gXCJsb2FkZWRcIiB8fCBzY3JpcHQucmVhZHlTdGF0ZSA9PSBcImNvbXBsZXRlXCIpIHtcbiAgICAgICAgICAgICAgICBzY3JpcHQub25yZWFkeXN0YXRlY2hhbmdlID0gbnVsbDtcbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSBlbHNlIHtcbiAgICAgICAgc2NyaXB0Lm9ubG9hZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgaWYgKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG4gICAgc2NyaXB0LnNyYyA9IHVybDtcbiAgICBpZiAoZWwpIHtcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZWwpLmFwcGVuZENoaWxkKHNjcmlwdCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgaGVhZC5pbnNlcnRCZWZvcmUoc2NyaXB0LCBoZWFkLmZpcnN0Q2hpbGQpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBZYXN1a28g6YWN572u5paH5Lu2XG4gKiDlpJror7Tor4TorrrosIPnlKjnrYlcbiAqL1xuXG52YXIgR2VuZXJhbCA9IHtcbiAgICBpc01vYmlsZTogZmFsc2UsXG4gICAgaXNXZWNoYXQ6IGZhbHNlLFxuICAgIHZpZXdXaWR0aDogJCh3aW5kb3cpLndpZHRoKCksXG4gICAgYWJzVXJsOiBsb2NhdGlvbi5wcm90b2NvbCArICcvLycgKyBsb2NhdGlvbi5ob3N0LFxuICAgIGluaXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgd2luID0gd2luZG93O1xuICAgICAgICB2YXIgZG9jID0gd2luLmRvY3VtZW50O1xuICAgICAgICB2YXIgVUEgPSBuYXZpZ2F0b3IudXNlckFnZW50LnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIHZhciBpc0FuZHJvaWQgPSB3aW4ubmF2aWdhdG9yLmFwcFZlcnNpb24ubWF0Y2goL2FuZHJvaWQvZ2kpO1xuICAgICAgICB2YXIgaXNJUGhvbmUgPSB3aW4ubmF2aWdhdG9yLmFwcFZlcnNpb24ubWF0Y2goL2lwaG9uZS9naSk7XG4gICAgICAgIGlmIChVQS5tYXRjaCgvTWljcm9NZXNzZW5nZXIvaSkgPT0gXCJtaWNyb21lc3NlbmdlclwiKSB7XG4gICAgICAgICAgICBHZW5lcmFsLmlzV2VjaGF0ID0gdHJ1ZTtcbiAgICAgICAgICAgICQoJ2JvZHknKS5hZGRDbGFzcygnd2VjaGF0LXdlYnZpZXcnKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoISFpc0FuZHJvaWQpIHtcbiAgICAgICAgICAgIEdlbmVyYWwuaXNNb2JpbGUgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmICgkKCdib2R5JykuaGFzQ2xhc3MoJ3Bvc3QtdGVtcGxhdGUnKSkge1xuICAgICAgICAgICAgR2VuZXJhbC51cGRhdGVJbWFnZVdpZHRoKCk7XG4gICAgICAgICAgICBHZW5lcmFsLnJld2FyZExvYWRlcigpO1xuICAgICAgICB9XG5cbiAgICAgICAgR2VuZXJhbC53ZWJGb250TG9hZGVyKCk7XG4gICAgICAgIEdlbmVyYWwuc2Nyb2xsVG9Qb3MoKTtcbiAgICB9LFxuICAgIHVwZGF0ZUltYWdlV2lkdGg6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgJHBvc3RDb250ZW50ID0gJChcIi5wb3N0LWNvbnRlbnRcIik7XG4gICAgICAgIC8vICRwb3N0Q29udGVudC5maXRWaWRzKCk7XG5cbiAgICAgICAgZnVuY3Rpb24gdXBkYXRlSW1hZ2VXaWR0aCgpIHtcbiAgICAgICAgICAgIHZhciAkdGhpcyA9ICQodGhpcyksXG4gICAgICAgICAgICAgICAgY29udGVudFdpZHRoID0gJHBvc3RDb250ZW50Lm91dGVyV2lkdGgoKSwgLy8gV2lkdGggb2YgdGhlIGNvbnRlbnRcbiAgICAgICAgICAgICAgICBpbWFnZVdpZHRoID0gdGhpcy5uYXR1cmFsV2lkdGg7IC8vIE9yaWdpbmFsIGltYWdlIHJlc29sdXRpb25cblxuICAgICAgICAgICAgaWYgKGltYWdlV2lkdGggPj0gY29udGVudFdpZHRoKSB7XG4gICAgICAgICAgICAgICAgJHRoaXMuYWRkQ2xhc3MoJ2Z1bGwtaW1nJyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICR0aGlzLnJlbW92ZUNsYXNzKCdmdWxsLWltZycpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdmFyICRpbWcgPSAkKFwiLnNpbmdsZS1wb3N0LWlubmVyIGltZ1wiKS5vbignbG9hZCcsIHVwZGF0ZUltYWdlV2lkdGgpO1xuXG4gICAgICAgIGZ1bmN0aW9uIGNhc3BlckZ1bGxJbWcoKSB7XG4gICAgICAgICAgICAkaW1nLmVhY2godXBkYXRlSW1hZ2VXaWR0aCk7XG4gICAgICAgIH1cblxuICAgICAgICBjYXNwZXJGdWxsSW1nKCk7XG4gICAgfSxcblxuICAgIC8vIEdlbmVyYWwuYWJzVXJsICsgJy9hc3NldHMvY3NzL2ZvbnQubWluLmNzcycgLy8g6L+Z5Liq5pivIEV4byDlrZfkvZPvvIzogIPomZHkuI3liqDovb3lroMs5o+Q6auY5pe26Ze0XG4gICAgd2ViRm9udExvYWRlcjogZnVuY3Rpb24oKSB7XG4gICAgICAgIFdlYkZvbnRDb25maWcgPSB7XG4gICAgICAgICAgICBsb2FkaW5nOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnbG9hZGluZyBmb250Jyk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgY3VzdG9tOiB7XG4gICAgICAgICAgICAgICAgZmFtaWxpZXM6IFsnaWNvbmZvbnQnLCAnZm9udGF3ZXNvbWUnXSxcbiAgICAgICAgICAgICAgICB1cmxzOiBbJ2h0dHBzOi8vaW1nLmhhbGZyb3N0LmNvbS9pY29uZm9udHMvaWNvbmZvbnQuY3NzJyxcbiAgICAgICAgICAgICAgICAgICAgICAgR2VuZXJhbC5hYnNVcmwgKyAnL2Fzc2V0cy9jc3MvZm9udC1hd2Vzb21lLm1pbi5jc3MnXG4gICAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBsb2FkSlMoR2VuZXJhbC5hYnNVcmwgKyAnL2Fzc2V0cy9qcy93ZWJmb250LmpzJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKCfliqDovb3lrZfkvZNKUycpO1xuICAgICAgICAgICAgV2ViRm9udC5sb2FkKHtcbiAgICAgICAgICAgICAgICBjdXN0b206IHtcbiAgICAgICAgICAgICAgICAgICAgZmFtaWxpZXM6IFsnaWNvbmZvbnQnLCAnZm9udGF3ZXNvbWUnXVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgLy/lubPmu5Hmu5rliqjliLDpobbpg6hcbiAgICBzY3JvbGxUb1BvczogZnVuY3Rpb24ocG9zaXRpb24pIHtcbiAgICAgICAgdmFyIFNUUl9UT19UT1AgPSAn5oiR6KaB6aOe5Yiw5pyA6auYJyxcbiAgICAgICAgICAgIGNvdmVySGVpZ2h0ID0gcG9zaXRpb24gfHwgJCh3aW5kb3cpLmhlaWdodCgpOyAvL+iOt+W+l+WbvueJh+mrmOW6plxuICAgICAgICB2YXIgYnV0dG9uID0gJCgnPGEgYXJpYS1sYWJlbD1cInRvcFwiIGhyZWY9XCIjXCIgaWQ9XCJ0by10b3BcIiB0aXRsZT1cIicgKyBTVFJfVE9fVE9QICsgJ1wiPiA8ZGl2IGNsYXNzPVwidG8tdG9wLXdyYXBcIj48L2Rpdj48L2E+JykuYXBwZW5kVG8oJ2JvZHknKTtcbiAgICAgICAgJCh3aW5kb3cpLnNjcm9sbChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGlmICgkKHdpbmRvdykuc2Nyb2xsVG9wKCkgPiAkKHdpbmRvdykuaGVpZ2h0KCkpIHtcbiAgICAgICAgICAgICAgICBidXR0b24uZmFkZUluKDUwMCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGJ1dHRvbi5mYWRlT3V0KDUwMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGJ1dHRvbi5jbGljayhmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAkKCdodG1sLGJvZHknKS5hbmltYXRlKHtcbiAgICAgICAgICAgICAgICBzY3JvbGxUb3A6IDBcbiAgICAgICAgICAgIH0sIDY2NiwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhhc2ggPSAnIyc7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ+aIkei3sycpO1xuICAgICAgICB9KTtcbiAgICB9LFxuICAgIC8q57uZ5paH56ug5Lit55qEdXJs5re75YqgaWNvbmZvbnTmlrnkvr/or4bliKsqL1xuICAgIHVybEljb25saXplOiBmdW5jdGlvbih1cmwpIHtcbiAgICAgICAgdmFyIGRvbWFpbixcbiAgICAgICAgICAgIF9vdXRwdXQ7XG4gICAgICAgIHZhciBpY29uRm9udFRhZyA9ICdpY29uZm9udCc7XG4gICAgICAgIHZhciBpY29uTWFwID0geyAvKue0ouW8lSDlj6/lnKjov5nph4zmt7vliqDljLnphY3op4TliJkqL1xuICAgICAgICAgICAgJ3R3aXR0ZXInOiAnaWNvbmZvbnQtdHdpdHRlciBpY29uLWljb25mb250dHdpdHRlcicsXG4gICAgICAgICAgICAncXpvbmUnOiAnaWNvbmZvbnQtcXpvbmUgaWNvbi1xem9uZScsXG4gICAgICAgICAgICAnd2VpYm8nOiAnaWNvbmZvbnQtd2VpYm8gaWNvbi1pY29uZm9udHdlaWJvJyxcbiAgICAgICAgICAgICdmYWNlYm9vayc6ICdpY29uZm9udC1mYWNlYm9vayBpY29uLWljb25mb250ZmFjZWJvb2snLFxuICAgICAgICAgICAgJ2dpdGh1Yic6ICdpY29uZm9udC1naXRodWIgaWNvbi1naXRodWInLFxuICAgICAgICAgICAgJ2RvdWJhbic6ICdpY29uZm9udC1kb3ViYW4gaWNvbi1pY29uZm9udGRvdWJhbicsXG4gICAgICAgICAgICAnZ29vZ2xlJzogJ2ljb25mb250LWdvb2dsZSBpY29uLWljb25mb250Z29vZ2xlJyxcbiAgICAgICAgICAgICdsdW9sZWknOiAnaWNvbmZvbnQtbHVvbGVpIGljb24tbHVvbGVpJyxcbiAgICAgICAgICAgICdkcmliYmxlJzogJ2ljb25mb250LWRyaWJibGUgaWNvbi1kcmliYmJsZWNpcmNsZWQnLFxuICAgICAgICAgICAgJ3YyZXgnOiAnaWNvbmZvbnQtdjJleCBpY29uLWljb25mb250djJleCcsXG4gICAgICAgICAgICAnemhpaHUnOiAnaWNvbmZvbnQtemhpaHUgaWNvbi1pY29uZm9udHpoaWh1JyxcbiAgICAgICAgICAgICd3aWtpcGVkaWEnOiAnaWNvbmZvbnQtd2lraXBlZGlhIGljb24taWNvbmZvbnR3aWtpcGVkaWEnLFxuICAgICAgICAgICAgJ2ppYW5zaHUnOiAnaWNvbmZvbnQtamlhbnNodSBpY29uLWppYW5zaHUnLFxuICAgICAgICAgICAgJ3lvdWt1JzogJ2ljb25mb250LXlvdWt1IGljb24taWNvbmZvbnR5b3VrdScsXG4gICAgICAgICAgICAneW91dHViZSc6ICdpY29uZm9udC15b3V0dWJlIGljb24teW91dHViZScsXG4gICAgICAgICAgICAnanVlamluJzonaWNvbmZvbnQtanVlamluIGljb24tanVlamluJyxcbiAgICAgICAgICAgICd3ZWl4aW4nOidpY29uZm9udC13ZWl4aW4gaWNvbi1pY29uZm9udHdlY2hhdCcsXG4gICAgICAgICAgICAnc2VnbWVudGZhdWx0JzonaWNvbmZvbnQtc2YgaWNvbi1pY29uc2YtY29weSdcbiAgICAgICAgfTtcblxuICAgICAgICBmb3IgKHZhciBuYW1lIGluIGljb25NYXApIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgaWNvbk1hcFtuYW1lXSAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgIHZhciBNYXBLZXkgPSBuYW1lO1xuICAgICAgICAgICAgICAgIGlmICh1cmwuaW5kZXhPZihNYXBLZXkpID49IDApIHtcbiAgICAgICAgICAgICAgICAgICAgZG9tYWluID0gTWFwS2V5O1xuICAgICAgICAgICAgICAgICAgICBfb3V0cHV0ID0gaWNvbk1hcFtNYXBLZXldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBfb3V0cHV0O1xuICAgIH0sXG4gICAgYWRkSWNvbnM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAvKue7meWNmuWuouaWh+eroOWcsOWdgHVybOa3u+WKoGljb+ivhuWIqyovXG4gICAgICAgICQoJy5zaW5nbGUtcG9zdC1pbm5lciAgYTpub3QoOmhhcyhpbWcpKScpLmVhY2goZnVuY3Rpb24oaSkge1xuICAgICAgICAgICAgdmFyIF9zcmMgPSAkKHRoaXMpLmF0dHIoJ2hyZWYnKTtcbiAgICAgICAgICAgIHZhciB0bXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG4gICAgICAgICAgICB0bXAuaHJlZiA9IF9zcmM7XG4gICAgICAgICAgICBfc2VsZkRvbWFpbiA9IHRtcC5ob3N0bmFtZTtcbiAgICAgICAgICAgIEdlbmVyYWwudXJsSWNvbmxpemUoX3NlbGZEb21haW4pO1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZyhfc2VsZkRvbWFpbik7XG4gICAgICAgICAgICAkKHRoaXMpLnByZXBlbmQoJzxpIGNsYXNzPVwiaWNvbmZvbnQgJyArIEdlbmVyYWwudXJsSWNvbmxpemUoX3NlbGZEb21haW4pICsgJ1wiPjwvaT4nKTtcbiAgICAgICAgICAgIHZhciBfc2VsZkNvbG9yID0gJCh0aGlzKS5maW5kKCdpJykuY3NzKCdjb2xvcicpLFxuICAgICAgICAgICAgICAgIF9vcmlnaW5hbENvbG9yID0gJCh0aGlzKS5jc3MoJ2NvbG9yJyk7XG5cbiAgICAgICAgICAgIC8q6byg5qCH5oKs5rWu5pe2Ki9cbiAgICAgICAgICAgICQodGhpcykuaG92ZXIoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgJCh0aGlzKS5jc3MoJ2NvbG9yJywgX3NlbGZDb2xvcik7XG4gICAgICAgICAgICAgICAgJCh0aGlzKS5hZGRDbGFzcygnYW5pbWF0ZWQgcHVsc2UnKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICQodGhpcykuY3NzKCdjb2xvcicsIF9vcmlnaW5hbENvbG9yKTtcbiAgICAgICAgICAgICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKCdhbmltYXRlZCBwdWxzZScpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSk7XG4gICAgfSxcbiAgICAvL+aJk+i1j1xuICAgIHJld2FyZExvYWRlcjogZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgdmFyIGxvYWRRUiA9IHtcbiAgICAgICAgICAgIGFsaXBheTogJy9hc3NldHMvaW1hZ2VzL3FyLWFsaXBheS0yNTUucG5nJyxcbiAgICAgICAgICAgIHdlY2hhdDogJy9hc3NldHMvaW1hZ2VzL3FyLXdlY2hhdC0yNTUucG5nJ1xuICAgICAgICB9O1xuICAgICAgICB2YXIgbG9hZFFSVXJsO1xuICAgICAgICBpZiAoISFHZW5lcmFsLmlzV2VjaGF0KSB7XG4gICAgICAgICAgICAkKCcud2VjaGF0LWNvZGUgYicpLmh0bWwoJ+mVv+aMieS4iuaWueS6jOe7tOeggeaJk+i1j+S9nOiAhScpO1xuICAgICAgICAgICAgLy8gJCgnLnFyLWNvZGUnKS5mYWRlT3V0KCk7XG4gICAgICAgIH1cblxuICAgICAgICAkKCcubW9uZXktbGlrZSAucmV3YXJkLWJ1dHRvbicpLmhvdmVyKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZygn5oKs5rWuJyk7XG4gICAgICAgICAgICAkKCdpbWcud2VjaGF0LWltZycpLmF0dHIoJ3NyYycsIGxvYWRRUi53ZWNoYXQpO1xuICAgICAgICAgICAgJCgnaW1nLmFsaXBheS1pbWcnKS5hdHRyKCdzcmMnLCBsb2FkUVIuYWxpcGF5KTtcbiAgICAgICAgICAgICQoJy5tb25leS1jb2RlJykuZmFkZUluKCk7XG4gICAgICAgICAgICAkKHRoaXMpLmFkZENsYXNzKCdhY3RpdmUnKTtcbiAgICAgICAgfSwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkKCcubW9uZXktY29kZScpLmZhZGVPdXQoKTtcbiAgICAgICAgICAgICQodGhpcykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICB9LCA4MDApO1xuXG4gICAgICAgICQoJy5tb25leS1saWtlIC5yZXdhcmQtYnV0dG9uJykuY2xpY2soZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAoJCh0aGlzKS5oYXNDbGFzcygnYWN0aXZlJykpIHtcbiAgICAgICAgICAgICAgICAkKHRoaXMpLmZpbmQoJ2ltZy53ZWNoYXQtaW1nJykuYXR0cignc3JjJywgbG9hZFFSLndlY2hhdCk7XG4gICAgICAgICAgICAgICAgJCh0aGlzKS5maW5kKCdpbWcuYWxpcGF5LWltZycpLmF0dHIoJ3NyYycsIGxvYWRRUi5hbGlwYXkpO1xuICAgICAgICAgICAgICAgICQoJy5tb25leS1jb2RlJykuZmFkZU91dCgpO1xuICAgICAgICAgICAgICAgICQodGhpcykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICQoJy5tb25leS1jb2RlJykuZmFkZUluKCk7XG4gICAgICAgICAgICAgICAgJCh0aGlzKS5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbn07XG5cbnZhciBJbWFnZVNtYXJ0TG9hZGVyID0ge1xuICAgIGlzV2ViUFN1cHBvcnRlZDogZmFsc2UsXG4gICAgaXNJbWFnZUNvbXByZXNzZWQ6IGZhbHNlLFxuICAgIGluaXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICBJbWFnZVNtYXJ0TG9hZGVyLndlYlBDaGVjaygpO1xuICAgIH0sXG4gICAgaXNDb21wcmVzc2VkQ2hlY2s6IGZ1bmN0aW9uKCkge1xuXG4gICAgfSxcbiAgICB3ZWJQQ2hlY2s6IGZ1bmN0aW9uKGZlYXR1cmUsIGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciBUZXN0SW1hZ2VzID0ge1xuICAgICAgICAgICAgZGVtbzogXCJVa2xHUmtvQUFBQlhSVUpRVmxBNFdBb0FBQUFRQUFBQUFBQUFBQUFBUVV4UVNBc0FBQUFCQnhBUkVZaUkvZ2NBQUFCV1VEZ2dHQUFBQURBQkFKMEJLZ0VBQVFBQkFCd2xwQUFEY0FEKy9nYlFBQT09XCJcbiAgICAgICAgfTtcbiAgICAgICAgICBjb25zb2xlLmxvZygn5pSv5oyBV2VicOWTpicpO1xuICAgICAgICB2YXIgaW1nID0gbmV3IEltYWdlKCk7XG4gICAgICAgIGltZy5vbmxvYWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSAoaW1nLndpZHRoID4gMCkgJiYgKGltZy5oZWlnaHQgPiAwKTtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ+aUr+aMgVdlYnAnKTtcbiAgICAgICAgICAgIC8vIGFsZXJ0KCfmlK/mjIEnKVxuICAgICAgICAgICAgSW1hZ2VTbWFydExvYWRlci5pc1dlYlBTdXBwb3J0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgSW1hZ2VTbWFydExvYWRlci53ZWJQTG9hZGVyKCk7XG4gICAgICAgIH07XG4gICAgICAgIGltZy5vbmVycm9yID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKCfkuI3mlK/mjIFXZWJwJyk7XG4gICAgICAgICAgICBJbWFnZVNtYXJ0TG9hZGVyLmlzV2ViUFN1cHBvcnRlZCA9IGZhbHNlO1xuICAgICAgICAgICAgSW1hZ2VTbWFydExvYWRlci53ZWJQTG9hZGVyKCk7XG4gICAgICAgIH07XG4gICAgICAgIGltZy5zcmMgPSBcImRhdGE6aW1hZ2Uvd2VicDtiYXNlNjQsXCIgKyBUZXN0SW1hZ2VzLmRlbW87XG5cbiAgICB9LFxuICAgIGltZ0xvYWRlcjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ+WKoOi9vem7mOiupOWbvueJhycpO1xuICAgIH0sXG4gICAgd2ViUExvYWRlcjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ+WKoOi9vXdlYlAnKTtcbiAgICAgICAgLy8gYWxlcnQoSW1hZ2VTbWFydExvYWRlci5pc1dlYlBTdXBwb3J0ZWQpO1xuICAgICAgICBpZiAoSW1hZ2VTbWFydExvYWRlci5pc1dlYlBTdXBwb3J0ZWQgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ+WuveW6puaYrycgKyBHZW5lcmFsLnZpZXdXaWR0aCk7XG4gICAgICAgICAgICBpZiAoR2VuZXJhbC52aWV3V2lkdGggPT0gNzY4KSB7XG4gICAgICAgICAgICAgICAgJChcIi5sYXp5XCIpLmxhenlsb2FkKHtcbiAgICAgICAgICAgICAgICAgICAgYWR2YW5jZWRfbG9hZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YV9hdHRyaWJ1dGU6ICd1cmwnLFxuICAgICAgICAgICAgICAgICAgICB3ZWJQX2xvYWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGlzX3NjYWxlOiBmYWxzZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChHZW5lcmFsLnZpZXdXaWR0aCA8IDc2OCkge1xuICAgICAgICAgICAgICAgICQoXCIubGF6eVwiKS5sYXp5bG9hZCh7XG4gICAgICAgICAgICAgICAgICAgIGFkdmFuY2VkX2xvYWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGRhdGFfYXR0cmlidXRlOiAndXJsJyxcbiAgICAgICAgICAgICAgICAgICAgd2ViUF9sb2FkOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBpc19zY2FsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgc2NhbGVfd2lkdGg6IDc1MFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBhbGVydCgn5pmu6YCa5pSv5oyBJylcbiAgICAgICAgICAgICAgICAkKFwiLmxhenlcIikubGF6eWxvYWQoe1xuICAgICAgICAgICAgICAgICAgICBhZHZhbmNlZF9sb2FkOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBkYXRhX2F0dHJpYnV0ZTogJ3VybCcsXG4gICAgICAgICAgICAgICAgICAgIHdlYlBfbG9hZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgaXNfc2NhbGU6IGZhbHNlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmIChHZW5lcmFsLnZpZXdXaWR0aCA9PSA3NjgpIHtcbiAgICAgICAgICAgICAgICAkKFwiLmxhenlcIikubGF6eWxvYWQoe1xuICAgICAgICAgICAgICAgICAgICBhZHZhbmNlZF9sb2FkOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBkYXRhX2F0dHJpYnV0ZTogJ3VybCcsXG4gICAgICAgICAgICAgICAgICAgIHdlYlBfbG9hZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGlzX3NjYWxlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBzY2FsZV93aWR0aDogMTUwMFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChHZW5lcmFsLnZpZXdXaWR0aCA8IDc2OCkge1xuICAgICAgICAgICAgICAgICQoXCIubGF6eVwiKS5sYXp5bG9hZCh7XG4gICAgICAgICAgICAgICAgICAgIGFkdmFuY2VkX2xvYWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGRhdGFfYXR0cmlidXRlOiAndXJsJyxcbiAgICAgICAgICAgICAgICAgICAgd2ViUF9sb2FkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgaXNfc2NhbGU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIHNjYWxlX3dpZHRoOiA3NTBcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gYWxlcnQoJ+aZrumAmuaUr+aMgScpXG4gICAgICAgICAgICAgICAgJChcIi5sYXp5XCIpLmxhenlsb2FkKHtcbiAgICAgICAgICAgICAgICAgICAgYWR2YW5jZWRfbG9hZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGRhdGFfYXR0cmlidXRlOiAndXJsJyxcbiAgICAgICAgICAgICAgICAgICAgd2ViUF9sb2FkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgaXNfc2NhbGU6IGZhbHNlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxufTtcblxuJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKSB7XG4gICAgdmFyICR3aW5kb3cgPSAkKHdpbmRvdyk7XG5cbiAgICAvLyBTY3JvbGwgdG8gY29udGVudFxuXHRcdC8vICQoJy5zY3JvbGwtZG93bicpLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcblx0XHQvLyBcdHZhciAkY292ZXIgPSAkKHRoaXMpLmNsb3Nlc3QoJy5jb3ZlcicpO1xuXHRcdC8vIFx0JCgnaHRtbCwgYm9keScpLmFuaW1hdGUoe1xuXHRcdC8vIFx0XHRzY3JvbGxUb3A6ICRjb3Zlci5wb3NpdGlvbigpLnRvcCArICRjb3Zlci5oZWlnaHQoKVxuXHRcdC8vIFx0fSwgODAwICk7XG5cdFx0Ly8gXHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0Ly8gfSk7XG5cbiAgICAvLyBhZGp1c3RDb3ZlcigpO1xuICAgIC8vIHZhciBsYXp5UmVzaXplID0gZGVib3VuY2UoYWRqdXN0Q292ZXIsIDIwMCwgZmFsc2UpO1xuICAgIC8vICQod2luZG93KS5yZXNpemUobGF6eVJlc2l6ZSk7XG5cbiAgICAvLyBTY3JvbGwgdG8gY29udGVudFxuICAgIHZhciBzY3JvbGxIaW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Njcm9sbC1oaW50Jyk7XG4gICAgaWYgKHNjcm9sbEhpbnQgIT09IG51bGwpIHtcbiAgICAgIC8vICAgc2Nyb2xsSGludC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuICAgICAgLy8gICAgIGlmICghc2Nyb2xsSGludC5jbGFzc0xpc3QuY29udGFpbnMoJ3Zpc2libGUnKSlcbiAgICAgIC8vICAgICAgICAgcmV0dXJuO1xuICAgICAgLy8gICAgICAgd2luZG93LnNjcm9sbEJ5KHtcbiAgICAgIC8vICAgICAgICAgdG9wOiB3aW5kb3cuaW5uZXJIZWlnaHQsXG4gICAgICAvLyAgICAgICAgIGxlZnQ6IDAsXG4gICAgICAvLyAgICAgICAgIGJlaGF2aW9yOiAnc21vb3RoJ1xuICAgICAgLy8gICAgIH0pO1xuICAgICAgLy8gfSk7XG5cbiAgICAgIC8vIFNjcm9sbCB0byBjb250ZW50XG5cdFx0JCgnLmhlYWRlci1zY3JvbGwtaGludCcpLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdHZhciAkY292ZXIgPSAkKHRoaXMpLmNsb3Nlc3QoJy5jb3ZlcicpO1xuXHRcdFx0JCgnaHRtbCwgYm9keScpLmFuaW1hdGUoe1xuXHRcdFx0XHRzY3JvbGxUb3A6ICRjb3Zlci5wb3NpdGlvbigpLnRvcCArICRjb3Zlci5oZWlnaHQoKVxuXHRcdFx0fSwgNDAwICk7XG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0fSk7XG5cbiAgICAgIC8vICQoJy5jb3ZlciAuYXJyb3ctZG93bicpLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcbiAgICAgIC8vICAgJCgnaHRtbCwgYm9keScpLmFuaW1hdGUoeydzY3JvbGxUb3AnOiAkKCcuY292ZXInKS5oZWlnaHQoKX0sIDgwMCk7XG4gICAgICAvLyAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIC8vIH0pO1xuXG4gICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHZhciBzY3JvbGxUb3AgPSB3aW5kb3cucGFnZVlPZmZzZXQgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcDtcbiAgICAgICAgICBpZiAoc2Nyb2xsVG9wID4gMCkge1xuICAgICAgICAgICAgICBzY3JvbGxIaW50LmNsYXNzTGlzdC5yZW1vdmUoJ3Zpc2libGUnKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBzY3JvbGxIaW50LmNsYXNzTGlzdC5hZGQoJ3Zpc2libGUnKTtcbiAgICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHZhciBzY3JvbGxUb3AgPSB3aW5kb3cucGFnZVlPZmZzZXQgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcDtcbiAgICAgICAgICBpZiAoc2Nyb2xsVG9wID4gMCkge1xuICAgICAgICAgICAgICBzY3JvbGxIaW50LmNsYXNzTGlzdC5yZW1vdmUoJ3Zpc2libGUnKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBzY3JvbGxIaW50LmNsYXNzTGlzdC5hZGQoJ3Zpc2libGUnKTtcbiAgICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBhZGp1c3RDb3ZlcigpIHtcblx0XHQgICAgc2V0RWxlbWVudEhlaWdodCgnLnBvc3QtaGVhZGVyLmNvdmVyJyk7XG5cdCAgfVxuXG4gICAgLy/liJ3lp4vljJYgdG9jIOaPkuS7tlxuICAgICQoJyN0b2MnKS5pbml0VE9DKHtcbiAgICAgICAgc2VsZWN0b3I6IFwiaDEsIGgyLCBoMywgaDQsIGg1LCBoNlwiLFxuICAgICAgICBzY29wZTogXCJhcnRpY2xlXCIsXG4gICAgICAgIG92ZXJ3cml0ZTogZmFsc2UsXG4gICAgICAgIHByZWZpeDogXCJ0b2NcIlxuICAgIH0pO1xuXG4gICAgLy/liqjmgIHorr7nva7moLflvI8s5L6L5aaCOua7muWKqOWIsOS4gOWumueoi+W6puS5i+WQjumakOiXj+ebruW9lVxuICAgIC8vIHZhciBtYXJfbGVmdCA9ICQoXCIucG9zdFwiKS53aWR0aCgpIC8gMiArIDIwO1xuICAgIC8vdmFyIHRvcCA9ICQoXCIjdG9jXCIpLmNzcyhcInRvcFwiKTsgIOi/meWPquiDveiOt+WPluexu+S8vDE1MnB455qE5a2X56ym5LiyLOS4i+mdouaJjeiDveiOt+WPluWAvFxuICAgIC8vdmFyIHRvcCA9ICQoXCIjdG9jXCIpLnBvc2l0aW9uKCkudG9wO1xuICAgIC8vIHZhciB0b3AgPSAkKHdpbmRvdykuaGVpZ2h0KCk7XG4gICAgLy8gJChcIiN0b2NcIikuY3NzKFwidG9wXCIsdG9wIC8gMi0gKHRvcCAvIDQpK1wicHhcIik7XG4gICAgLy8gJChcIiN0b2Mgb2xcIikuaHRtbChmdW5jdGlvbihpLG9yaWdUZXh0KXtcbiAgICAvLyAgICAgcmV0dXJuIG9yaWdUZXh0ICsgXCI8bGk+PGEgaWQ9J3Njcm9sbFRvcCcgaHJlZj0nIyc+6L+U5Zue6aG26YOoPC9hPjwvbGk+XCI7XG4gICAgLy8gfSk7XG4gICAgLy8gJChcIiN0b2NcIikuY3NzKHtcIm1hcmdpbi1sZWZ0XCI6bWFyX2xlZnQrXCJweFwifSk7XG5cbiAgICAvLyAkKHdpbmRvdykuc2Nyb2xsKGZ1bmN0aW9uKCl7XG4gICAgLy8gICAgIHZhciB3aW5kb3dfb2Zmc2V0ID0gJCh3aW5kb3cpLnNjcm9sbFRvcCgpO1xuICAgIC8vICAgICB2YXIgbWFpbl9oZWFkZXJfaGVpZ2h0ID0gJChcIi5tYWluLWhlYWRlclwiKS5oZWlnaHQoKTtcbiAgICAvLyAgICAgdmFyIGNvbnRlbnRfaGVpZ2h0ID0gJChcIi5jb250ZW50XCIpLmhlaWdodCgpO1xuICAgIC8vICAgICBpZih3aW5kb3dfb2Zmc2V0IDwgbWFpbl9oZWFkZXJfaGVpZ2h0IC0gMTAwKSB7XG4gICAgLy8gICAgICAgICAkKFwiI3RvY1wiKS5oaWRlKCk7XG4gICAgLy8gICAgICAgICAvL+S4i+mdoueahOadoeS7tuS4jeiDveeUqCBhPng+Y+i/meenjeW9ouW8jyzlj6rog73nlKgmJi7ouqvkuLrkuIDkuKrliY3nq6/lsI/nmb3ooajnpLrkvKTkuI3otbcuLi5cbiAgICAvLyAgICAgfWVsc2UgaWYod2luZG93X29mZnNldCA+IG1haW5faGVhZGVyX2hlaWdodCYmbWFpbl9oZWFkZXJfaGVpZ2h0K2NvbnRlbnRfaGVpZ2h0IC0gNTAwID4gd2luZG93X29mZnNldCkge1xuICAgIC8vICAgICAgICAgJChcIiN0b2NcIikuc2hvdygpO1xuICAgIC8vICAgICB9ZWxzZXtcbiAgICAvLyAgICAgICAgICQoXCIjdG9jXCIpLmhpZGUoKTtcbiAgICAvLyAgICAgfVxuICAgIC8vIH0pO1xuXG5cdCAgLy8gU2V0IHRoZSBuZXcgaGVpZ2h0IG9mIGFuIGVsZW1lbnRcblx0ICBmdW5jdGlvbiBzZXRFbGVtZW50SGVpZ2h0KGVsZW1lbnQpe1xuXHRcdCAgICB2YXIgd2luZG93SGVpZ2h0ID0gKCB0cnVlPT09aXNpUG9kKCkgJiYgdHJ1ZT09PWlzU2FmYXJpKCkgKSA/IHdpbmRvdy5zY3JlZW4uYXZhaWxIZWlnaHQgOiAkKHdpbmRvdykuaGVpZ2h0KCk7XG5cdFx0ICAgICAgdmFyIG9mZnNldEhlaWdodCA9ICQoJy5zaXRlLWhlYWRlcicpLm91dGVySGVpZ2h0KCk7XG5cdFx0ICAgICAgICB2YXIgbmV3SGVpZ2h0ID0gd2luZG93SGVpZ2h0O1xuXHRcdCAgICAgICAgICBpZiAoICQoZWxlbWVudCkuZmluZCgnLnNjcm9sbC1kb3duJykuaXMoJzpoaWRkZW4nKSApIHtcblx0XHRcdCAgICAgICAgICAgICAkKGVsZW1lbnQpLnJlbW92ZUF0dHIoJ3N0eWxlJyk7XG5cdFx0XHQgICAgICAgICAgICAgICAgJChlbGVtZW50KS5maW5kKCcuY292ZXItYmcnKS5jc3MoJ3RvcCcsJycpO1xuXHRcdCAgICAgICAgICB9XG5cdFx0ICAgICAgICAgIGVsc2Uge1xuXHRcdFx0ICAgICAgICAgICAgICQoZWxlbWVudCkub3V0ZXJIZWlnaHQobmV3SGVpZ2h0KTtcblx0XHRcdCAgICAgICAgICAgICAgICAkKGVsZW1lbnQpLmZpbmQoJy5jb3Zlci1iZycpLmNzcygndG9wJyxvZmZzZXRIZWlnaHQpO1xuXHRcdCAgICAgICAgICB9XG5cdCAgfVxuXG5cdCAgLy8gVGhyb3R0bGVzIGFuIGFjdGlvbi5cblx0ICAvLyBUYWtlbiBmcm9tIFVuZGVyc2NvcmUuanMuXG5cdCAgZnVuY3Rpb24gZGVib3VuY2UgKGZ1bmMsIHdhaXQsIGltbWVkaWF0ZSkge1xuXHRcdCAgICB2YXIgdGltZW91dCwgYXJncywgY29udGV4dCwgdGltZXN0YW1wLCByZXN1bHQ7XG5cdFx0ICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuXHRcdFx0ICAgICAgICAgY29udGV4dCA9IHRoaXM7XG5cdFx0XHQgICAgICAgICBhcmdzID0gYXJndW1lbnRzO1xuXHRcdFx0ICAgICAgICAgdGltZXN0YW1wID0gbmV3IERhdGUoKTtcblx0XHRcdCAgICAgICAgIHZhciBsYXRlciA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHQgICAgICAgICAgICB2YXIgbGFzdCA9IChuZXcgRGF0ZSgpKSAtIHRpbWVzdGFtcDtcblx0XHRcdFx0ICAgICAgICAgICAgaWYgKGxhc3QgPCB3YWl0KSB7XG5cdFx0XHRcdFx0ICAgICAgICAgICAgIHRpbWVvdXQgPSBzZXRUaW1lb3V0KGxhdGVyLCB3YWl0IC0gbGFzdCk7XG5cdFx0XHRcdCAgICAgICAgICAgIH0gZWxzZSB7XG5cdFx0XHRcdFx0ICAgICAgICAgICAgICB0aW1lb3V0ID0gbnVsbDtcblx0XHRcdFx0XHQgICAgICAgICAgICAgIGlmICghaW1tZWRpYXRlKSB7XG5cdFx0XHRcdFx0XHQgICAgICAgICAgICAgICAgcmVzdWx0ID0gZnVuYy5hcHBseShjb250ZXh0LCBhcmdzKTtcblx0XHRcdFx0XHQgICAgICAgICAgICAgIH1cblx0XHRcdFx0ICAgICAgICAgICAgfVxuXHRcdFx0ICAgICAgICAgfTtcblx0XHRcdCAgICAgICAgIHZhciBjYWxsTm93ID0gaW1tZWRpYXRlICYmICF0aW1lb3V0O1xuXHRcdFx0ICAgICAgICAgICAgaWYgKCF0aW1lb3V0KSB7XG5cdFx0XHRcdCAgICAgICAgICAgICAgICB0aW1lb3V0ID0gc2V0VGltZW91dChsYXRlciwgd2FpdCk7XG5cdFx0XHQgICAgICAgICAgICB9XG5cdFx0XHQgICAgICAgICAgICBpZiAoY2FsbE5vdykge1xuXHRcdFx0XHQgICAgICAgICAgICAgICAgcmVzdWx0ID0gZnVuYy5hcHBseShjb250ZXh0LCBhcmdzKTtcblx0XHRcdCAgICAgICAgICAgIH1cblx0XHRcdCAgICByZXR1cm4gcmVzdWx0O1xuXHRcdCAgICAgIH07XG5cdCAgfVxuXG5cdCAgLy8gQ2hlY2sgaWYgZGV2aWNlIGlzIGFuIGlQaG9uZSBvciBpUG9kXG5cdCAgZnVuY3Rpb24gaXNpUG9kKCl7XG5cdFx0ICAgIHJldHVybigvKGlQaG9uZXxpUG9kKS9nKS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpO1xuXHQgIH1cblxuXHQgIC8vIENoZWNrIGlmIGJyb3dzZXIgaXMgU2FmYXJpXG5cdCAgZnVuY3Rpb24gaXNTYWZhcmkoKXtcblx0XHQgICAgcmV0dXJuKC0xIT09bmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCdTYWZhcmknKSYmLTE9PT1uYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoJ0Nocm9tZScpKTtcblx0ICB9XG5cblx0XHQvLyBIaWRkZW4gc2VjdGlvbnNcblx0XHQkKCcuc2lkZWJhci10b2dnbGUnKS5vbignY2xpY2snLCBmdW5jdGlvbihlKXtcblx0XHRcdC8vICQoJ2JvZHknKS50b2dnbGVDbGFzcygnc2lkZWJhci1vcGVuZWQnKTsg5YiH5o2i57G75Yir5Y+v5Lul55u05o6l55SoIHRvZ2dsZUNsYXNzXG4gICAgICBpZiAoICQoJ2JvZHknKS5oYXNDbGFzcygnc2lkZWJhci1vcGVuZWQnKSApIHtcblx0XHRcdFx0JCgnYm9keScpLnJlbW92ZUNsYXNzKCdzaWRlYmFyLW9wZW5lZCcpO1xuICAgICAgICAkKCdib2R5JykuY3NzKCdvdmVyZmxvdycsJ3Njcm9sbCcpOyAvLyDmgaLlpI0gYm9kee+8jOWFgeiuuOS4i+Wxgua7keWKqFxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0JCgnYm9keScpLmFkZENsYXNzKCdzaWRlYmFyLW9wZW5lZCcpO1xuICAgICAgICAkKCdib2R5JykuY3NzKCdvdmVyZmxvdycsJ2hpZGRlbicpOyAvLyDplIHlrpogYm9kee+8jOemgeatouS4i+Wxgua7keWKqFxuXHRcdFx0fVxuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdH0pO1xuXG5cdFx0JCgnLnNlYXJjaC10b2dnbGUnKS5vbignY2xpY2snLCBmdW5jdGlvbihlKXtcblx0XHRcdGlmICggJCgnYm9keScpLmhhc0NsYXNzKCdzZWFyY2gtb3BlbmVkJykgKSB7XG5cdFx0XHRcdCQoJ2JvZHknKS5yZW1vdmVDbGFzcygnc2VhcmNoLW9wZW5lZCcpO1xuICAgICAgICAkKCdib2R5JykuY3NzKCdvdmVyZmxvdycsJ3Njcm9sbCcpOyAvLyDmgaLlpI0gYm9kee+8jOWFgeiuuOS4i+Wxgua7keWKqFxuXHRcdFx0XHRzZWFyY2hGaWVsZC5jbGVhcigpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0JCgnYm9keScpLmFkZENsYXNzKCdzZWFyY2gtb3BlbmVkJyk7XG4gICAgICAgICQoJ2JvZHknKS5jc3MoJ292ZXJmbG93JywnaGlkZGVuJyk7IC8vIOmUgeWumiBib2R577yM56aB5q2i5LiL5bGC5ruR5YqoXG5cdFx0XHRcdHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0JCgnI3NlYXJjaC1maWVsZCcpLmZvY3VzKCk7XG5cdFx0XHRcdH0sIDMwMCk7XG5cdFx0XHR9XG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0fSk7XG5cdFx0JCgnLm92ZXJsYXknKS5vbignY2xpY2snLCBmdW5jdGlvbihlKXtcblx0XHRcdCQoJ2JvZHknKS5yZW1vdmVDbGFzcygnc2lkZWJhci1vcGVuZWQgc2VhcmNoLW9wZW5lZCcpO1xuICAgICAgJCgnYm9keScpLmNzcygnb3ZlcmZsb3cnLCdzY3JvbGwnKTsgLy8g5oGi5aSNIGJvZHnvvIzlhYHorrjkuIvlsYLmu5Hliqhcblx0XHRcdHNlYXJjaEZpZWxkLmNsZWFyKCk7XG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0fSk7XG5cbiAgICAvLyBTaG93IGNvbW1lbnRzXG5cdFx0aWYgKCB0eXBlb2YgZGlzcXVzX3Nob3J0bmFtZSAhPT0gJ3VuZGVmaW5lZCcgKSB7XG5cdFx0XHR2YXIgZGlzcXVzX2xvYWRlZCA9IGZhbHNlO1xuXHRcdFx0JCgnLmNvbW1lbnRzLXRpdGxlJykub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHZhciBfdGhpcyA9ICQodGhpcyk7XG5cdFx0XHRcdGlmICggISBkaXNxdXNfbG9hZGVkICkge1xuXHRcdFx0XHRcdCQuYWpheCh7XG5cdFx0XHRcdFx0XHR0eXBlOiBcIkdFVFwiLFxuXHRcdFx0XHRcdFx0dXJsOiBcIi8vXCIgKyBkaXNxdXNfc2hvcnRuYW1lICsgXCIuZGlzcXVzLmNvbS9lbWJlZC5qc1wiLFxuXHRcdFx0XHRcdFx0ZGF0YVR5cGU6IFwic2NyaXB0XCIsXG5cdFx0XHRcdFx0XHRjYWNoZTogdHJ1ZVxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdF90aGlzLmFkZENsYXNzKCd0b2dnbGVkLW9uJyk7XG5cdFx0XHRcdFx0ZGlzcXVzX2xvYWRlZCA9IHRydWU7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0JCgnI2Rpc3F1c190aHJlYWQnKS5zbGlkZVRvZ2dsZSgpO1xuXHRcdFx0XHRcdGlmICggX3RoaXMuaGFzQ2xhc3MoJ3RvZ2dsZWQtb24nKSApIHtcblx0XHRcdFx0XHRcdF90aGlzLnJlbW92ZUNsYXNzKCd0b2dnbGVkLW9uJyk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdF90aGlzLmFkZENsYXNzKCd0b2dnbGVkLW9uJyk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHR9XG5cbiAgICAkLmZuLmxhenlsb2FkID0gZnVuY3Rpb24ob3B0aW9ucykge1xuICAgICAgICB2YXIgZWxlbWVudHMgPSB0aGlzO1xuICAgICAgICB2YXIgJGNvbnRhaW5lcjtcbiAgICAgICAgdmFyIHNldHRpbmdzID0ge1xuICAgICAgICAgICAgdGhyZXNob2xkOiAwLFxuICAgICAgICAgICAgZmFpbHVyZV9saW1pdDogMCxcbiAgICAgICAgICAgIGV2ZW50OiBcInNjcm9sbFwiLFxuICAgICAgICAgICAgZWZmZWN0OiBcInNob3dcIixcbiAgICAgICAgICAgIGNvbnRhaW5lcjogd2luZG93LFxuICAgICAgICAgICAgZGF0YV9hdHRyaWJ1dGU6IFwib3JpZ2luYWxcIixcbiAgICAgICAgICAgIHNraXBfaW52aXNpYmxlOiBmYWxzZSxcbiAgICAgICAgICAgIGFwcGVhcjogbnVsbCxcbiAgICAgICAgICAgIGxvYWQ6IG51bGwsXG4gICAgICAgICAgICBwbGFjZWhvbGRlcjogXCJcIixcbiAgICAgICAgICAgIGFkdmFuY2VkX2xvYWQ6IGZhbHNlLFxuICAgICAgICAgICAgd2ViUF9sb2FkOiBmYWxzZSxcbiAgICAgICAgICAgIGlzX3NjYWxlOiBmYWxzZSxcbiAgICAgICAgICAgIHNjYWxlX3dpZHRoOiA3NTBcbiAgICAgICAgfTtcblxuICAgICAgICBmdW5jdGlvbiB1cGRhdGUoKSB7XG4gICAgICAgICAgICB2YXIgY291bnRlciA9IDA7XG5cbiAgICAgICAgICAgIGVsZW1lbnRzLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgdmFyICR0aGlzID0gJCh0aGlzKTtcblxuICAgICAgICAgICAgICAgIGlmIChzZXR0aW5ncy5za2lwX2ludmlzaWJsZSAmJiAhJHRoaXMuaXMoXCI6dmlzaWJsZVwiKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICgkLmFib3ZldGhldG9wKHRoaXMsIHNldHRpbmdzKSB8fFxuICAgICAgICAgICAgICAgICAgICAkLmxlZnRvZmJlZ2luKHRoaXMsIHNldHRpbmdzKSkge1xuICAgICAgICAgICAgICAgICAgICAvKiBOb3RoaW5nLiAqL1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoISQuYmVsb3d0aGVmb2xkKHRoaXMsIHNldHRpbmdzKSAmJlxuICAgICAgICAgICAgICAgICAgICAhJC5yaWdodG9mZm9sZCh0aGlzLCBzZXR0aW5ncykpIHtcbiAgICAgICAgICAgICAgICAgICAgJHRoaXMudHJpZ2dlcihcImFwcGVhclwiKTtcbiAgICAgICAgICAgICAgICAgICAgLyogaWYgd2UgZm91bmQgYW4gaW1hZ2Ugd2UnbGwgbG9hZCwgcmVzZXQgdGhlIGNvdW50ZXIgKi9cbiAgICAgICAgICAgICAgICAgICAgY291bnRlciA9IDA7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCsrY291bnRlciA+IHNldHRpbmdzLmZhaWx1cmVfbGltaXQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH1cblxuICAgICAgICBpZiAob3B0aW9ucykge1xuICAgICAgICAgICAgLyogTWFpbnRhaW4gQkMgZm9yIGEgY291cGxlIG9mIHZlcnNpb25zLiAqL1xuICAgICAgICAgICAgaWYgKHVuZGVmaW5lZCAhPT0gb3B0aW9ucy5mYWlsdXJlbGltaXQpIHtcbiAgICAgICAgICAgICAgICBvcHRpb25zLmZhaWx1cmVfbGltaXQgPSBvcHRpb25zLmZhaWx1cmVsaW1pdDtcbiAgICAgICAgICAgICAgICBkZWxldGUgb3B0aW9ucy5mYWlsdXJlbGltaXQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodW5kZWZpbmVkICE9PSBvcHRpb25zLmVmZmVjdHNwZWVkKSB7XG4gICAgICAgICAgICAgICAgb3B0aW9ucy5lZmZlY3Rfc3BlZWQgPSBvcHRpb25zLmVmZmVjdHNwZWVkO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSBvcHRpb25zLmVmZmVjdHNwZWVkO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAkLmV4dGVuZChzZXR0aW5ncywgb3B0aW9ucyk7XG4gICAgICAgIH1cblxuICAgICAgICAvKiBDYWNoZSBjb250YWluZXIgYXMgalF1ZXJ5IGFzIG9iamVjdC4gKi9cbiAgICAgICAgJGNvbnRhaW5lciA9IChzZXR0aW5ncy5jb250YWluZXIgPT09IHVuZGVmaW5lZCB8fFxuICAgICAgICAgICAgc2V0dGluZ3MuY29udGFpbmVyID09PSB3aW5kb3cpID8gJHdpbmRvdyA6ICQoc2V0dGluZ3MuY29udGFpbmVyKTtcblxuICAgICAgICAvKiBGaXJlIG9uZSBzY3JvbGwgZXZlbnQgcGVyIHNjcm9sbC4gTm90IG9uZSBzY3JvbGwgZXZlbnQgcGVyIGltYWdlLiAqL1xuICAgICAgICBpZiAoMCA9PT0gc2V0dGluZ3MuZXZlbnQuaW5kZXhPZihcInNjcm9sbFwiKSkge1xuICAgICAgICAgICAgJGNvbnRhaW5lci5iaW5kKHNldHRpbmdzLmV2ZW50LCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygn5rua5Yqo5LqGMTExJyk7XG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ+a7muWKqCcpO1xuICAgICAgICAgICAgICAgIHJldHVybiB1cGRhdGUoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICAgICAgdmFyICRzZWxmID0gJChzZWxmKTtcblxuICAgICAgICAgICAgc2VsZi5sb2FkZWQgPSBmYWxzZTtcblxuICAgICAgICAgICAgLyogSWYgbm8gc3JjIGF0dHJpYnV0ZSBnaXZlbiB1c2UgZGF0YTp1cmkuICovXG4gICAgICAgICAgICBpZiAoJHNlbGYuYXR0cihcInNyY1wiKSA9PT0gdW5kZWZpbmVkIHx8ICRzZWxmLmF0dHIoXCJzcmNcIikgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgaWYgKCRzZWxmLmlzKFwiaW1nXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgICRzZWxmLmF0dHIoXCJzcmNcIiwgc2V0dGluZ3MucGxhY2Vob2xkZXIpO1xuICAgICAgICAgICAgICAgICAgICAkc2VsZi5hZGRDbGFzcyhcImxvYWRpbmdcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKiBXaGVuIGFwcGVhciBpcyB0cmlnZ2VyZWQgbG9hZCBvcmlnaW5hbCBpbWFnZS4gKi9cbiAgICAgICAgICAgICRzZWxmLm9uZShcImFwcGVhclwiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMubG9hZGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZXR0aW5ncy5hcHBlYXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbGVtZW50c19sZWZ0ID0gZWxlbWVudHMubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0dGluZ3MuYXBwZWFyLmNhbGwoc2VsZiwgZWxlbWVudHNfbGVmdCwgc2V0dGluZ3MpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJzEuc2VsZi5hdHRyID0gJywkc2VsZik7XG4gICAgICAgICAgICAgICAgICAgIHZhciB1cGRhdGVkVXJsID0gJHNlbGYuYXR0cihcImRhdGEtXCIgKyBzZXR0aW5ncy5kYXRhX2F0dHJpYnV0ZSk7XG4gICAgICAgICAgICAgICAgICAgIC8vIHZhciB1cGRhdGVkVXJsID0gJHNlbGYuYXR0cihcImRhdGEtb3JpZ2luYWxcIik7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHVwZGF0ZWRVcmwgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZWRVcmwgPSAkc2VsZi5hdHRyKFwic3JjXCIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICh1cGRhdGVkVXJsID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygn5rWL6K+VID0gJywkc2VsZi5zdHlsZSk7XG4gICAgICAgICAgICAgICAgICAgICAgdXBkYXRlZFVybCA9ICRzZWxmLnN0eWxlLmJhY2tncm91bmRJbWFnZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAodXBkYXRlZFVybCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygndXBkYXRlZFVybCA9ICcsdXBkYXRlZFVybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygn5Zu+54mH5Zyw5Z2AJyArdXBkYXRlZFVybC5pbmRleE9mKCdpbWcuaGFsZnJvc3QuY29tJykpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0NETuWcsOWdgCcgK3VwZGF0ZWRVcmwuaW5kZXhPZignZmlsZS5pczI2LmNvbScpKTtcbiAgICAgICAgICAgICAgICAgICAgICBpZiAodXBkYXRlZFVybC5pbmRleE9mKCdpbWcuaGFsZnJvc3QuY29tJykgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBhbGVydCgxKVxuICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2V0dGluZ3MuYWR2YW5jZWRfbG9hZCA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlZFVybCArPSAnP2ltYWdlVmlldzInO1xuICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZXR0aW5ncy5pc19zY2FsZSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlZFVybCArPSAnLzAvdy8nICsgc2V0dGluZ3Muc2NhbGVfd2lkdGg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNldHRpbmdzLndlYlBfbG9hZCA9PT0gdHJ1ZSAmJiBzZXR0aW5ncy5pc19zY2FsZSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZWRVcmwgKz0gJy8wL2Zvcm1hdC93ZWJwJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2V0dGluZ3Mud2ViUF9sb2FkID09PSB0cnVlICYmIHNldHRpbmdzLmlzX3NjYWxlID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVkVXJsICs9ICcvZm9ybWF0L3dlYnAnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHN1cHBvcnQgU2FmYXJpIGFuZCBpT1NcbiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNldHRpbmdzLndlYlBfbG9hZCA9PT0gZmFsc2UgJiYgdXBkYXRlZFVybC5pbmRleE9mKCdodHRwczovL2ltZy5oYWxmcm9zdC5jb20vQmxvZy9BcnRpY2xlVGl0bGVJbWFnZS9iYWNrZ3JvdW5kLWNvdmVyXy5wbmcnKSA+IC0xICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZWRVcmwgPSAnaHR0cHM6Ly9pbWcuaGFsZnJvc3QuY29tL0Jsb2cvQXJ0aWNsZVRpdGxlSW1hZ2UvYmFja2dyb3VuZC1jb3Zlcl8ucG5nJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpZiAodXBkYXRlZFVybC5pbmRleE9mKCdodHRwczovL2ltZy5oYWxmcm9zdC5jb20vQmxvZy9BcnRpY2xlVGl0bGVJbWFnZS9iYWNrZ3JvdW5kLWNvdmVyXy5wbmcnKSA+IC0xICYmIHNldHRpbmdzLndlYlBfbG9hZCA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgIHVwZGF0ZWRVcmwgPSAnaHR0cHM6Ly9pbWcuaGFsZnJvc3QuY29tL0Jsb2cvQXJ0aWNsZVRpdGxlSW1hZ2UvYmFja2dyb3VuZC1jb3Zlcl8ucG5nP2ltYWdlVmlldzIvMC9mb3JtYXQvd2VicCc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIC8vIH1cbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCfkuK3pl7TmiZPljbB1cGRhdGVkVXJsJyx1cGRhdGVkVXJsKTtcbiAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnKioqKioqKioq5Lit6Ze05omT5Y2wIGltZy5zcmMgPSAnLCRzZWxmLmF0dHIoXCJzcmNcIikpO1xuICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCcqKioqKioqKirkuK3pl7TmiZPljbAgaW1nID0gJywkKFwiPGltZyAvPlwiKSk7XG5cbiAgICAgICAgICAgICAgICAgICAgJChcIjxpbWcgLz5cIikuYmluZChcImxvYWRcIiwgZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2VsZi5oaWRlKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHNlbGYuaXMoXCJpbWdcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNlbGYuYXR0cihcInNyY1wiLCB1cGRhdGVkVXJsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnKioqKioqKioqaW1nLnNyYyA9ICcsJHNlbGYuYXR0cihcInNyY1wiKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNlbGYuY3NzKFwiYmFja2dyb3VuZC1pbWFnZVwiLCBcInVybCgnXCIgKyB1cGRhdGVkVXJsICsgXCInKVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnKioqKioqKioqYmFja2dyb3VuZC1pbWFnZSA9ICcsJHNlbGYuY3NzKFwiYmFja2dyb3VuZC1pbWFnZVwiKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzZWxmW3NldHRpbmdzLmVmZmVjdF0oc2V0dGluZ3MuZWZmZWN0X3NwZWVkKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYubG9hZGVkID0gdHJ1ZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qIFJlbW92ZSBpbWFnZSBmcm9tIGFycmF5IHNvIGl0IGlzIG5vdCBsb29wZWQgbmV4dCB0aW1lLiAqL1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ZW1wID0gJC5ncmVwKGVsZW1lbnRzLCBmdW5jdGlvbihlbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAhZWxlbWVudC5sb2FkZWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudHMgPSAkKHRlbXApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNldHRpbmdzLmxvYWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVsZW1lbnRzX2xlZnQgPSBlbGVtZW50cy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldHRpbmdzLmxvYWQuY2FsbChzZWxmLCBlbGVtZW50c19sZWZ0LCBzZXR0aW5ncyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzZWxmLnJlbW92ZUNsYXNzKFwibG9hZGluZ1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcInNyY1wiLCB1cGRhdGVkVXJsKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLyogV2hlbiB3YW50ZWQgZXZlbnQgaXMgdHJpZ2dlcmVkIGxvYWQgb3JpZ2luYWwgaW1hZ2UgKi9cbiAgICAgICAgICAgIC8qIGJ5IHRyaWdnZXJpbmcgYXBwZWFyLiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpZiAoMCAhPT0gc2V0dGluZ3MuZXZlbnQuaW5kZXhPZihcInNjcm9sbFwiKSkge1xuICAgICAgICAgICAgICAgICRzZWxmLmJpbmQoc2V0dGluZ3MuZXZlbnQsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXNlbGYubG9hZGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2VsZi50cmlnZ2VyKFwiYXBwZWFyXCIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8qIENoZWNrIGlmIHNvbWV0aGluZyBhcHBlYXJzIHdoZW4gd2luZG93IGlzIHJlc2l6ZWQuICovXG4gICAgICAgICR3aW5kb3cuYmluZChcInJlc2l6ZVwiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHVwZGF0ZSgpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvKiBXaXRoIElPUzUgZm9yY2UgbG9hZGluZyBpbWFnZXMgd2hlbiBuYXZpZ2F0aW5nIHdpdGggYmFjayBidXR0b24uICovXG4gICAgICAgIC8qIE5vbiBvcHRpbWFsIHdvcmthcm91bmQuICovXG4gICAgICAgIGlmICgoLyg/OmlwaG9uZXxpcG9kfGlwYWQpLipvcyA1L2dpKS50ZXN0KG5hdmlnYXRvci5hcHBWZXJzaW9uKSkge1xuICAgICAgICAgICAgJHdpbmRvdy5iaW5kKFwicGFnZXNob3dcIiwgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgICAgICAgICBpZiAoZXZlbnQub3JpZ2luYWxFdmVudCAmJiBldmVudC5vcmlnaW5hbEV2ZW50LnBlcnNpc3RlZCkge1xuICAgICAgICAgICAgICAgICAgICBlbGVtZW50cy5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS50cmlnZ2VyKFwiYXBwZWFyXCIpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qIEZvcmNlIGluaXRpYWwgY2hlY2sgaWYgaW1hZ2VzIHNob3VsZCBhcHBlYXIuICovXG4gICAgICAgICQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdXBkYXRlKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG5cbiAgICAvKiBDb252ZW5pZW5jZSBtZXRob2RzIGluIGpRdWVyeSBuYW1lc3BhY2UuICAgICAgICAgICAqL1xuICAgIC8qIFVzZSBhcyAgJC5iZWxvd3RoZWZvbGQoZWxlbWVudCwge3RocmVzaG9sZCA6IDEwMCwgY29udGFpbmVyIDogd2luZG93fSkgKi9cblxuICAgICQuYmVsb3d0aGVmb2xkID0gZnVuY3Rpb24oZWxlbWVudCwgc2V0dGluZ3MpIHtcbiAgICAgICAgdmFyIGZvbGQ7XG5cbiAgICAgICAgaWYgKHNldHRpbmdzLmNvbnRhaW5lciA9PT0gdW5kZWZpbmVkIHx8IHNldHRpbmdzLmNvbnRhaW5lciA9PT0gd2luZG93KSB7XG4gICAgICAgICAgICBmb2xkID0gKHdpbmRvdy5pbm5lckhlaWdodCA/IHdpbmRvdy5pbm5lckhlaWdodCA6ICR3aW5kb3cuaGVpZ2h0KCkpICsgJHdpbmRvdy5zY3JvbGxUb3AoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGZvbGQgPSAkKHNldHRpbmdzLmNvbnRhaW5lcikub2Zmc2V0KCkudG9wICsgJChzZXR0aW5ncy5jb250YWluZXIpLmhlaWdodCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGZvbGQgPD0gJChlbGVtZW50KS5vZmZzZXQoKS50b3AgLSBzZXR0aW5ncy50aHJlc2hvbGQ7XG4gICAgfTtcblxuICAgICQucmlnaHRvZmZvbGQgPSBmdW5jdGlvbihlbGVtZW50LCBzZXR0aW5ncykge1xuICAgICAgICB2YXIgZm9sZDtcblxuICAgICAgICBpZiAoc2V0dGluZ3MuY29udGFpbmVyID09PSB1bmRlZmluZWQgfHwgc2V0dGluZ3MuY29udGFpbmVyID09PSB3aW5kb3cpIHtcbiAgICAgICAgICAgIGZvbGQgPSAkd2luZG93LndpZHRoKCkgKyAkd2luZG93LnNjcm9sbExlZnQoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGZvbGQgPSAkKHNldHRpbmdzLmNvbnRhaW5lcikub2Zmc2V0KCkubGVmdCArICQoc2V0dGluZ3MuY29udGFpbmVyKS53aWR0aCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGZvbGQgPD0gJChlbGVtZW50KS5vZmZzZXQoKS5sZWZ0IC0gc2V0dGluZ3MudGhyZXNob2xkO1xuICAgIH07XG5cbiAgICAkLmFib3ZldGhldG9wID0gZnVuY3Rpb24oZWxlbWVudCwgc2V0dGluZ3MpIHtcbiAgICAgICAgdmFyIGZvbGQ7XG5cbiAgICAgICAgaWYgKHNldHRpbmdzLmNvbnRhaW5lciA9PT0gdW5kZWZpbmVkIHx8IHNldHRpbmdzLmNvbnRhaW5lciA9PT0gd2luZG93KSB7XG4gICAgICAgICAgICBmb2xkID0gJHdpbmRvdy5zY3JvbGxUb3AoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGZvbGQgPSAkKHNldHRpbmdzLmNvbnRhaW5lcikub2Zmc2V0KCkudG9wO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGZvbGQgPj0gJChlbGVtZW50KS5vZmZzZXQoKS50b3AgKyBzZXR0aW5ncy50aHJlc2hvbGQgKyAkKGVsZW1lbnQpLmhlaWdodCgpO1xuICAgIH07XG5cbiAgICAkLmxlZnRvZmJlZ2luID0gZnVuY3Rpb24oZWxlbWVudCwgc2V0dGluZ3MpIHtcbiAgICAgICAgdmFyIGZvbGQ7XG5cbiAgICAgICAgaWYgKHNldHRpbmdzLmNvbnRhaW5lciA9PT0gdW5kZWZpbmVkIHx8IHNldHRpbmdzLmNvbnRhaW5lciA9PT0gd2luZG93KSB7XG4gICAgICAgICAgICBmb2xkID0gJHdpbmRvdy5zY3JvbGxMZWZ0KCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBmb2xkID0gJChzZXR0aW5ncy5jb250YWluZXIpLm9mZnNldCgpLmxlZnQ7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZm9sZCA+PSAkKGVsZW1lbnQpLm9mZnNldCgpLmxlZnQgKyBzZXR0aW5ncy50aHJlc2hvbGQgKyAkKGVsZW1lbnQpLndpZHRoKCk7XG4gICAgfTtcblxuICAgICQuaW52aWV3cG9ydCA9IGZ1bmN0aW9uKGVsZW1lbnQsIHNldHRpbmdzKSB7XG5cbiAgICAgICAgcmV0dXJuICEkLnJpZ2h0b2Zmb2xkKGVsZW1lbnQsIHNldHRpbmdzKSAmJiAhJC5sZWZ0b2ZiZWdpbihlbGVtZW50LCBzZXR0aW5ncykgJiZcbiAgICAgICAgICAgICEkLmJlbG93dGhlZm9sZChlbGVtZW50LCBzZXR0aW5ncykgJiYgISQuYWJvdmV0aGV0b3AoZWxlbWVudCwgc2V0dGluZ3MpO1xuICAgIH07XG5cbiAgICAvKiBDdXN0b20gc2VsZWN0b3JzIGZvciB5b3VyIGNvbnZlbmllbmNlLiAgICovXG4gICAgLyogVXNlIGFzICQoXCJpbWc6YmVsb3ctdGhlLWZvbGRcIikuc29tZXRoaW5nKCkgb3IgKi9cbiAgICAvKiAkKFwiaW1nXCIpLmZpbHRlcihcIjpiZWxvdy10aGUtZm9sZFwiKS5zb21ldGhpbmcoKSB3aGljaCBpcyBmYXN0ZXIgKi9cblxuICAgICQuZXh0ZW5kKCQuZXhwcltcIjpcIl0sIHtcbiAgICAgICAgXCJiZWxvdy10aGUtZm9sZFwiOiBmdW5jdGlvbihhKSB7XG4gICAgICAgICAgICByZXR1cm4gJC5iZWxvd3RoZWZvbGQoYSwge1xuICAgICAgICAgICAgICAgIHRocmVzaG9sZDogMFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIFwiYWJvdmUtdGhlLXRvcFwiOiBmdW5jdGlvbihhKSB7XG4gICAgICAgICAgICByZXR1cm4gISQuYmVsb3d0aGVmb2xkKGEsIHtcbiAgICAgICAgICAgICAgICB0aHJlc2hvbGQ6IDBcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICBcInJpZ2h0LW9mLXNjcmVlblwiOiBmdW5jdGlvbihhKSB7XG4gICAgICAgICAgICByZXR1cm4gJC5yaWdodG9mZm9sZChhLCB7XG4gICAgICAgICAgICAgICAgdGhyZXNob2xkOiAwXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcbiAgICAgICAgXCJsZWZ0LW9mLXNjcmVlblwiOiBmdW5jdGlvbihhKSB7XG4gICAgICAgICAgICByZXR1cm4gISQucmlnaHRvZmZvbGQoYSwge1xuICAgICAgICAgICAgICAgIHRocmVzaG9sZDogMFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIFwiaW4tdmlld3BvcnRcIjogZnVuY3Rpb24oYSkge1xuICAgICAgICAgICAgcmV0dXJuICQuaW52aWV3cG9ydChhLCB7XG4gICAgICAgICAgICAgICAgdGhyZXNob2xkOiAwXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcbiAgICAgICAgLyogTWFpbnRhaW4gQkMgZm9yIGNvdXBsZSBvZiB2ZXJzaW9ucy4gKi9cbiAgICAgICAgXCJhYm92ZS10aGUtZm9sZFwiOiBmdW5jdGlvbihhKSB7XG4gICAgICAgICAgICByZXR1cm4gISQuYmVsb3d0aGVmb2xkKGEsIHtcbiAgICAgICAgICAgICAgICB0aHJlc2hvbGQ6IDBcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICBcInJpZ2h0LW9mLWZvbGRcIjogZnVuY3Rpb24oYSkge1xuICAgICAgICAgICAgcmV0dXJuICQucmlnaHRvZmZvbGQoYSwge1xuICAgICAgICAgICAgICAgIHRocmVzaG9sZDogMFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIFwibGVmdC1vZi1mb2xkXCI6IGZ1bmN0aW9uKGEpIHtcbiAgICAgICAgICAgIHJldHVybiAhJC5yaWdodG9mZm9sZChhLCB7XG4gICAgICAgICAgICAgICAgdGhyZXNob2xkOiAwXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgR2VuZXJhbC5pbml0KCk7XG4gICAgSW1hZ2VTbWFydExvYWRlci5pbml0KCk7XG4gICAgaWYgKCQoJ2JvZHknKS5oYXNDbGFzcygncG9zdC10ZW1wbGF0ZScpKSB7XG4gICAgICAgIEdlbmVyYWwuYWRkSWNvbnMoKTtcbiAgICB9XG5cbiAgICAvLyBTaXRlIHNlYXJjaFxuICAgIC8vIHZhciBzZWFyY2hGaWVsZCA9ICQoJyNzZWFyY2gtZmllbGQnKS5naG9zdEh1bnRlcih7XG4gICAgLy8gICByZXN1bHRzIDogXCIjc2VhcmNoLXJlc3VsdHNcIixcbiAgICAvLyAgIG9uS2V5VXAgOiB0cnVlLFxuICAgIC8vICAgb25QYWdlTG9hZCA6IHRydWUsXG4gICAgLy8gICBpbmNsdWRlcGFnZXMgOiB0cnVlLFxuICAgIC8vICAgaW5mb190ZW1wbGF0ZSA6ICc8ZGl2IGNsYXNzPVwicmVzdWx0cy1pbmZvXCI+UG9zdHMgZm91bmQ6IHt7YW1vdW50fX08L2Rpdj4nLFxuICAgIC8vICAgcmVzdWx0X3RlbXBsYXRlIDogJzxkaXYgY2xhc3M9XCJyZXN1bHQtaXRlbVwiPjxhIGhyZWY9XCJ7e2xpbmt9fVwiPjxkaXYgY2xhc3M9XCJyZXN1bHQtdGl0bGVcIj57e3RpdGxlfX08L2Rpdj48ZGl2IGNsYXNzPVwicmVzdWx0LWRhdGVcIj57e3B1YkRhdGV9fTwvZGl2PjwvYT48L2Rpdj4nXG4gICAgLy8gfSk7XG59KTtcbiIsIihmdW5jdGlvbiAoZmFjdG9yeSkge1xuICAgIGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHtcbiAgICAgICAgLy8gQU1ELiBSZWdpc3RlciBhcyBhbiBhbm9ueW1vdXMgbW9kdWxlLlxuICAgICAgICBkZWZpbmUoWydqcXVlcnknXSwgZmFjdG9yeSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgLy8gQnJvd3NlciBnbG9iYWxzXG4gICAgICAgIGZhY3RvcnkoalF1ZXJ5KTtcbiAgICB9XG59KGZ1bmN0aW9uICgkKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgLyoqXG4gICAgICogZ2V0IGhlYWRlciBsZXZlbFxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBoZWFkZXI6IGhlYWRlcidzIHRhZyBuYW1lXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIHtOdW1iZXJ9XG4gICAgICovXG4gICAgdmFyIGdldExldmVsID0gZnVuY3Rpb24gKGhlYWRlcikge1xuICAgICAgICBpZiAodHlwZW9mIGhlYWRlciAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGRlY3MgPSBoZWFkZXIubWF0Y2goL1xcZC9nKTtcbiAgICAgICAgcmV0dXJuIGRlY3MgPyBNYXRoLm1pbi5hcHBseShudWxsLCBkZWNzKSA6IDE7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIGNyZWF0ZSBvcmRlcmVkIGxpc3RcbiAgICAgKiBAcGFyYW0ge2pRdWVydH0gJHdyYXBwZXJcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gY291bnRcbiAgICAgKlxuICAgICAqIEByZXR1cm4ge2pRdWVyeX0gbGlzdFxuICAgICAqL1xuICAgIHZhciBjcmVhdGVMaXN0ID0gZnVuY3Rpb24gKCR3cmFwcGVyLCBjb3VudCkge1xuICAgICAgICB3aGlsZSAoY291bnQtLSkge1xuICAgICAgICAgICAgJHdyYXBwZXIgPSAkKCc8b2wvPicpLmFwcGVuZFRvKCR3cmFwcGVyKTtcblxuICAgICAgICAgICAgaWYgKGNvdW50KSB7XG4gICAgICAgICAgICAgICAgJHdyYXBwZXIgPSAkKCc8bGkvPicpLmFwcGVuZFRvKCR3cmFwcGVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiAkd3JhcHBlcjtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogaW5zZXJ0IHBvc2l0aW9uIGp1bXAgYmFja1xuICAgICAqIEBwYXJhbSB7alF1ZXJ5fSAkY3VycmVudFdyYXBwZXI6IGN1cnJlbnQgaW5zZXJ0IHBvaW50XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IG9mZnNldDogZGlzdGFuY2UgYmV0d2VlbiBjdXJyZW50J3MgYW5kIHRhcmdldCdzIGRlcHRoXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIHtqUXVlcnl9IGluc2VydCBwb2ludFxuICAgICAqL1xuICAgIHZhciBqdW1wQmFjayA9IGZ1bmN0aW9uICgkY3VycmVudFdyYXBwZXIsIG9mZnNldCkge1xuICAgICAgICB3aGlsZSAob2Zmc2V0LS0pIHtcbiAgICAgICAgICAgICRjdXJyZW50V3JhcHBlciA9ICRjdXJyZW50V3JhcHBlci5wYXJlbnQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiAkY3VycmVudFdyYXBwZXI7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIHNldCBlbGVtZW50IGhyZWYvaWQgYW5kIGNvbnRlbnRcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IG92ZXJ3cml0ZTogd2hldGhlciBvdmVyd3JpdGUgc291cmNlIGVsZW1lbnQgZXhpc3RlZCBpZFxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBwcmVmaXg6IHByZWZpeCB0byBwcmVwZW5kIHRvIGhyZWYvaWRcbiAgICAgKlxuICAgICAqIEByZXR1cm4ge0Z1bmN0aW9ufVxuICAgICAqL1xuICAgIHZhciBzZXRBdHRycyA9IGZ1bmN0aW9uIChvdmVyd3JpdGUsIHByZWZpeCkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCRzcmMsICR0YXJnZXQsIGluZGV4KSB7XG4gICAgICAgICAgICB2YXIgY29udGVudCA9ICRzcmMudGV4dCgpO1xuICAgICAgICAgICAgdmFyIHByZSA9IHByZWZpeCArICctJyArIGluZGV4O1xuICAgICAgICAgICAgJHRhcmdldC50ZXh0KGNvbnRlbnQpO1xuXG4gICAgICAgICAgICB2YXIgc3JjID0gJHNyY1swXTtcbiAgICAgICAgICAgIHZhciB0YXJnZXQgPSAkdGFyZ2V0WzBdO1xuICAgICAgICAgICAgdmFyIGlkID0gb3ZlcndyaXRlID8gcHJlIDogKHNyYy5pZCB8fCBwcmUpO1xuXG4gICAgICAgICAgICBpZCA9IGVuY29kZVVSSUNvbXBvbmVudChpZCk7XG5cbiAgICAgICAgICAgIHNyYy5pZCA9IGlkO1xuICAgICAgICAgICAgdGFyZ2V0LmhyZWYgPSAnIycgKyBpZDtcbiAgICAgICAgfTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogYnVpbGQgdGFibGUgb2YgY29udGVudHNcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb3B0aW9uc1xuICAgICAqXG4gICAgICogQHJldHVybiB7alF1ZXJ5fSBsaXN0XG4gICAgICovXG4gICAgdmFyIGJ1aWxkVE9DID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgICAgICAgdmFyIHNlbGVjdG9yID0gb3B0aW9ucy5zZWxlY3RvcjtcbiAgICAgICAgdmFyIHNjb3BlID0gb3B0aW9ucy5zY29wZTtcblxuICAgICAgICB2YXIgJHJldCA9ICQoJzxvbC8+Jyk7XG4gICAgICAgIHZhciAkd3JhcHBlciA9ICRyZXQ7XG4gICAgICAgIHZhciAkbGFzdExpID0gbnVsbDtcblxuICAgICAgICB2YXIgcHJldkRlcHRoID0gZ2V0TGV2ZWwoc2VsZWN0b3IpO1xuICAgICAgICB2YXIgX3NldEF0dHJzID0gc2V0QXR0cnMob3B0aW9ucy5vdmVyd3JpdGUsIG9wdGlvbnMucHJlZml4KTtcblxuICAgICAgICAkKHNjb3BlKVxuICAgICAgICAgICAgLmZpbmQoc2VsZWN0b3IpXG4gICAgICAgICAgICAuZWFjaChmdW5jdGlvbiAoaW5kZXgsIGVsZW0pIHtcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudERlcHRoID0gZ2V0TGV2ZWwoZWxlbS50YWdOYW1lKTtcbiAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0ID0gY3VycmVudERlcHRoIC0gcHJldkRlcHRoO1xuXG4gICAgICAgICAgICAgICAgaWYgKG9mZnNldCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgJHdyYXBwZXIgPSBjcmVhdGVMaXN0KCRsYXN0TGksIG9mZnNldCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKG9mZnNldCA8IDApIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gc2hvdWxkIGJlIG9uY2UgbW9yZSBsZXZlbCB0byBqdW1wIGJhY2tcbiAgICAgICAgICAgICAgICAgICAgLy8gZWc6IGgyICsgaDMgKyBoMiwgb2Zmc2V0ID0gaDIgLSBoMyA9IC0xXG4gICAgICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgICAgIC8vIG9sIDwtLS0tLS0rIHRhcmdldFxuICAgICAgICAgICAgICAgICAgICAvLyAgIGxpICAgICAgfFxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgb2wgLS0tKyBjdXJyZW50XG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgIGxpXG4gICAgICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgICAgIC8vIGp1bXBiYWNrID0gdGFyZ2V0IC0gY3VycmVudCA9IDJcbiAgICAgICAgICAgICAgICAgICAgJHdyYXBwZXIgPSBqdW1wQmFjaygkd3JhcHBlciwgLW9mZnNldCAqIDIpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICghJHdyYXBwZXIubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICR3cmFwcGVyID0gJHJldDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgJGxpID0gJCgnPGxpLz4nKTtcbiAgICAgICAgICAgICAgICB2YXIgJGEgPSAkKCc8YS8+Jyk7XG5cbiAgICAgICAgICAgICAgICBfc2V0QXR0cnMoJChlbGVtKSwgJGEsIGluZGV4KTtcblxuICAgICAgICAgICAgICAgICRsaS5hcHBlbmQoJGEpLmFwcGVuZFRvKCR3cmFwcGVyKTtcblxuICAgICAgICAgICAgICAgICRsYXN0TGkgPSAkbGk7XG4gICAgICAgICAgICAgICAgcHJldkRlcHRoID0gY3VycmVudERlcHRoO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuICRyZXQ7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIGluaXQgdGFibGUgb2YgY29udGVudHNcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbl06IFRPQyBvcHRpb25zLCBhdmFpbGFibGUgcHJvcHM6XG4gICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7U3RyaW5nfSBbc2VsZWN0b3JdOiBoZWFkZXJzIHNlbGVjdG9yLCBkZWZhdWx0IGlzICdoMSwgaDIsIGgzLCBoNCwgaDUsIGg2J1xuICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1N0cmluZ30gW3Njb3BlXTogc2VsZWN0b3IgdG8gc3BlY2lmeSBlbGVtZW50cyBzZWFyY2ggc2NvcGUsIGRlZmF1bHQgaXMgJ2JvZHknXG4gICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7Qm9vbGVhbn0gW292ZXJ3cml0ZV06IHdoZXRoZXIgdG8gb3ZlcndyaXRlIGV4aXN0ZWQgaGVhZGVycycgaWQsIGRlZmF1bHQgaXMgZmFsc2VcbiAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtTdHJpbmd9IFtwcmVmaXhdOiBzdHJpbmcgdG8gcHJlcGVuZCB0byBpZC9ocmVmIHByb3AsIGRlZmF1bHQgaXMgJ3RvYydcbiAgICAgKlxuICAgICAqIEByZXR1cm4ge2pRdWVyeX0gJHRoaXNcbiAgICAgKi9cbiAgICAkLmZuLmluaXRUT0MgPSBmdW5jdGlvbiAob3B0aW9ucykge1xuICAgICAgICB2YXIgZGVmYXVsdE9wdHMgPSB7XG4gICAgICAgICAgICBzZWxlY3RvcjogJ2gxLCBoMiwgaDMsIGg0LCBoNSwgaDYnLFxuICAgICAgICAgICAgc2NvcGU6ICdib2R5JyxcbiAgICAgICAgICAgIG92ZXJ3cml0ZTogZmFsc2UsXG4gICAgICAgICAgICBwcmVmaXg6ICd0b2MnXG4gICAgICAgIH07XG5cbiAgICAgICAgb3B0aW9ucyA9ICQuZXh0ZW5kKGRlZmF1bHRPcHRzLCBvcHRpb25zKTtcblxuICAgICAgICB2YXIgc2VsZWN0b3IgPSBvcHRpb25zLnNlbGVjdG9yO1xuXG4gICAgICAgIGlmICh0eXBlb2Ygc2VsZWN0b3IgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdzZWxlY3RvciBtdXN0IGJlIGEgc3RyaW5nJyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIXNlbGVjdG9yLm1hdGNoKC9eKD86aFsxLTZdLD9cXHMqKSskL2cpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdzZWxlY3RvciBtdXN0IGNvbnRhaW5zIG9ubHkgaDEtNicpO1xuICAgICAgICB9XG5cbiAgICAgICAgJCh0aGlzKS5hcHBlbmQoYnVpbGRUT0Mob3B0aW9ucykpO1xuXG4gICAgICAgIHZhciBjdXJyZW50SGFzaCA9IGxvY2F0aW9uLmhhc2g7XG5cbiAgICAgICAgaWYgKGN1cnJlbnRIYXNoKSB7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgYW5jaG9yID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoY3VycmVudEhhc2guc2xpY2UoMSkpO1xuICAgICAgICAgICAgICAgIGlmIChhbmNob3IpIGFuY2hvci5zY3JvbGxJbnRvVmlldygpO1xuICAgICAgICAgICAgfSwgMCk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gJCh0aGlzKTtcbiAgICB9O1xufSkpO1xuIl19
